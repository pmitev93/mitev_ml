(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{Ki94:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var i=s("mrSG"),a=s("hnrn");let r=(()=>{class e{constructor(e){Object.assign(this,e||{})}get id(){return this.pId}set id(e){this.pId=e}get usrId(){return this.pUsrId}set usrId(e){this.pUsrId=e}get credType(){return this.pCredType}set credType(e){this.pCredType=e}get identifierNo(){return this.pIdentifierNo}set identifierNo(e){this.pIdentifierNo=e}get isNonExpired(){return this.pIsNonExpired}set isNonExpired(e){this.pIsNonExpired=e}get isNonLocked(){return this.pIsNonLocked}set isNonLocked(e){this.pIsNonLocked=e}get passwd(){return this.pPasswd}set passwd(e){this.pPasswd=e}get dateCreated(){return this.pDateCreated}set dateCreated(e){this.pDateCreated=e}get isApproved(){return this.pIsApproved}set isApproved(e){this.pIsApproved=e}}return e.url="TrnUserCredentials",e.publicUrl="Public/TrnUserCredentials",Object(i.b)([Object(a.b)({alias:"id"})],e.prototype,"pId",void 0),Object(i.b)([Object(a.b)({alias:"usrId"})],e.prototype,"pUsrId",void 0),Object(i.b)([Object(a.b)({alias:"credType"})],e.prototype,"pCredType",void 0),Object(i.b)([Object(a.b)({alias:"identifierNo"})],e.prototype,"pIdentifierNo",void 0),Object(i.b)([Object(a.b)({alias:"isNonExpired"})],e.prototype,"pIsNonExpired",void 0),Object(i.b)([Object(a.b)({alias:"isNonLocked"})],e.prototype,"pIsNonLocked",void 0),Object(i.b)([Object(a.b)({alias:"passwd"})],e.prototype,"pPasswd",void 0),Object(i.b)([Object(a.b)({alias:"dateCreated"})],e.prototype,"pDateCreated",void 0),Object(i.b)([Object(a.b)({alias:"isApproved"})],e.prototype,"pIsApproved",void 0),e})()},Yj9t:function(e,t,s){"use strict";s.r(t),s.d(t,"AuthModule",(function(){return ls}));var i=s("ofXK"),a=s("tyNb"),r=s("xtxY"),n=s("fXoL"),o=s("ShMd"),c=s("1kSV"),d=s("Jrli"),l=s("sYmb");function g(e,t){1&e&&(n.Sb(0,"div",10),n.Sb(1,"h6",11),n.Gc(2),n.hc(3,"translate"),n.Rb(),n.Rb()),2&e&&(n.zb(2),n.Hc(n.ic(3,1,"registration.data")))}function h(e,t){if(1&e){const e=n.Tb();n.Sb(0,"app-user-registration",12),n.ec("formStatusValidChanged",(function(t){return n.wc(e),n.gc().onValidityChanged(t)})),n.Rb()}if(2&e){const e=n.gc();n.mc("index","0")("model",e.model)}}const b=function(){return["profile-data"]};let u=(()=>{class e{constructor(){this.model={},this.isFormValid=!1,this.VALID="VALID"}ngOnInit(){this.model.user=new r.a}onValidityChanged(e){this.isFormValid=e===this.VALID}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Gb({type:e,selectors:[["app-registration-page"]],decls:13,vars:7,consts:[[1,"row","no-gutters"],[1,"col-md-12"],[3,"showBtn"],[1,"container-fluid","px-3"],[1,"text-center","my-4"],["id","accordion",3,"destroyOnHide","activeIds"],["acc","ngbAccordion"],["id","profile-data"],["ngbPanelHeader",""],["id","body","ngbPanelContent",""],[1,"d-flex","align-items-center","justify-content-between"],[1,"m-0"],[3,"index","model","formStatusValidChanged"]],template:function(e,t){1&e&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Nb(2,"app-subheader",2),n.Sb(3,"div",3),n.Sb(4,"div",4),n.Sb(5,"h4"),n.Gc(6),n.hc(7,"translate"),n.Rb(),n.Rb(),n.Sb(8,"ngb-accordion",5,6),n.Sb(10,"ngb-panel",7),n.Ec(11,g,4,3,"ng-template",8),n.Ec(12,h,1,2,"ng-template",9),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Rb()),2&e&&(n.zb(2),n.mc("showBtn",!1),n.zb(4),n.Hc(n.ic(7,4,"registration.users")),n.zb(2),n.mc("destroyOnHide",!1)("activeIds",n.pc(6,b)))},directives:[o.a,c.a,c.I,c.K,c.J,d.a],pipes:[l.d],styles:["[_nghost-%COMP%]     #accordion>div>div.card-header, [_nghost-%COMP%]     #accordion>div>div>div.card-body{padding:.5rem}"]}),e})();var m=s("mrSG"),p=s("HayI"),S=s("zazq"),f=s("ZRIf"),v=s("4XRX"),R=s("qSrz"),M=s("9cUh");function I(e,t){1&e&&n.Nb(0,"i",18)}function D(e,t){1&e&&n.Nb(0,"i",19)}const E=function(e,t){return{"list-group-item-secondary":e,"list-group-item-success":t}};function O(e,t){if(1&e){const e=n.Tb();n.Sb(0,"button",11),n.ec("click",(function(){n.wc(e);const s=t.$implicit;return n.gc().onClickCompanyFirm(s)})),n.Sb(1,"div",12),n.Sb(2,"div",6),n.Sb(3,"span",13),n.Ec(4,I,1,0,"i",14),n.Ec(5,D,1,0,"i",15),n.Gc(6),n.Rb(),n.Rb(),n.Sb(7,"div",16),n.Sb(8,"div",6),n.Sb(9,"span",17),n.Gc(10),n.Rb(),n.Sb(11,"span"),n.Gc(12),n.Rb(),n.Rb(),n.Sb(13,"div",6),n.Sb(14,"span",17),n.Gc(15,"\u041f\u0440\u0430\u0432\u043e \u043d\u0430 \u0434\u043e\u0441\u0442\u044a\u043f: "),n.Rb(),n.Sb(16,"span"),n.Gc(17),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Rb()}if(2&e){const e=t.$implicit;n.mc("ngClass",n.rc(7,E,t.index%2==0&&!e.isSelected,e.isSelected)),n.zb(4),n.mc("ngIf",e.isActive),n.zb(1),n.mc("ngIf",!e.isActive),n.zb(1),n.Ic(" ",e.name," "),n.zb(4),n.Hc("E"===e.indOrEntity?"\u0415\u0418\u041a\xa0:":"\u0415\u0413\u041d\xa0:"),n.zb(2),n.Hc("E"===e.indOrEntity?e.bulstat:e.egn),n.zb(5),n.Hc(e.roleDesc)}}let w=(()=>{class e{constructor(e,t){this.router=e,this.mainService=t,this.TRN_ORGANIZATIONS_RESOURCE_NAME="TrnOrganizations",this.USER_ROLE_RESOURCE_NAME=this.TRN_ORGANIZATIONS_RESOURCE_NAME+"/userRole",this.itemList=null,this.selectedOrgClick=new n.n}ngOnInit(){}onClickCompanyFirm(e){this.mainService.loadByParam(Object,this.USER_ROLE_RESOURCE_NAME,e.id).subscribe(t=>{const s={};s.organization=e,s.permits=t,this.selectedOrgClick.emit(s)},e=>{})}onClickRegObligatedPersonBtn(){this.router.navigate(["auth/profile/debtors"])}onClickAddToTeamBtn(){this.router.navigate(["auth/profile/user-organization"])}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(a.c),n.Mb(f.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-organization-selector"]],inputs:{itemList:"itemList"},outputs:{selectedOrgClick:"selectedOrgClick"},decls:17,vars:1,consts:[[1,"container"],[1,"card"],[1,"card-header"],[1,"card-body","p-2"],[1,"list-group"],["type","button","class","list-group-item list-group-item-action ",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"d-flex"],[1,"flex-fill","pr-1"],["type","button",1,"btn","btn-primary","btn-lg","btn-block",3,"click"],[1,"flex-fill","pl-1"],[1,"card-footer"],["type","button",1,"list-group-item","list-group-item-action",3,"ngClass","click"],[1,"d-flex","flex-column"],[1,"font-weight-bold"],["class","fas fa-user-check text-success","style","font-size: 20px",4,"ngIf"],["class","fas fa-user-edit text-danger","style","font-size: 20px",4,"ngIf"],[1,"d-flex","flex-row","justify-content-between"],[1,"mr-2","font-weight-bold"],[1,"fas","fa-user-check","text-success",2,"font-size","20px"],[1,"fas","fa-user-edit","text-danger",2,"font-size","20px"]],template:function(e,t){1&e&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Sb(2,"div",2),n.Sb(3,"h5"),n.Gc(4,"\u0421\u043f\u0438\u0441\u044a\u043a \u043d\u0430 \u0430\u0441\u043e\u0446\u0438\u0438\u0440\u0430\u043d\u0438\u0442\u0435 \u0437\u0430\u0434\u044a\u043b\u0436\u0435\u043d\u0438 \u043b\u0438\u0446\u0430"),n.Rb(),n.Rb(),n.Sb(5,"div",3),n.Sb(6,"div",4),n.Ec(7,O,18,10,"button",5),n.Rb(),n.Rb(),n.Sb(8,"div",3),n.Sb(9,"div",6),n.Sb(10,"div",7),n.Sb(11,"button",8),n.ec("click",(function(){return t.onClickRegObligatedPersonBtn()})),n.Gc(12,"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043d\u0430 \u0437\u0430\u0434\u044a\u043b\u0436\u0435\u043d\u043e \u043b\u0438\u0446\u0435"),n.Rb(),n.Rb(),n.Sb(13,"div",9),n.Sb(14,"button",8),n.ec("click",(function(){return t.onClickAddToTeamBtn()})),n.Gc(15,"\u041c\u043e\u043b\u0431\u0430 \u0437\u0430 \u0432\u043a\u043b\u044e\u0447\u0432\u0430\u043d\u0435 \u0432 \u0435\u043a\u0438\u043f"),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Nb(16,"div",10),n.Rb(),n.Rb()),2&e&&(n.zb(7),n.mc("ngForOf",t.itemList))},directives:[i.t,i.r,i.u],styles:[""]}),e})();const N=function(e,t){return{"list-group-item-secondary":e,"list-group-item-success":t}};function C(e,t){if(1&e){const e=n.Tb();n.Sb(0,"button",7),n.ec("click",(function(){n.wc(e);const s=t.$implicit;return n.gc().onClickCompanyRole(s)})),n.Sb(1,"div",8),n.Sb(2,"div",9),n.Sb(3,"span",10),n.Nb(4,"i",11),n.Gc(5),n.Rb(),n.Rb(),n.Rb(),n.Rb()}if(2&e){const e=t.$implicit;n.mc("ngClass",n.rc(2,N,t.index%2==0&&!e.isSelected,e.isSelected)),n.zb(5),n.Ic(" ",e.description," ")}}let y=(()=>{class e{constructor(e,t){this.router=e,this.mainService=t,this.TRNUSER_ROLES_RESOURCE_NAME="TrnUserRoles",this.CFGBUSINESS_FUNCTIONS_RESOURCE_NAME=this.TRNUSER_ROLES_RESOURCE_NAME+"/cfgBusinessFunctions",this.itemList=null,this.selectedRoleClick=new n.n}ngOnInit(){}onClickCompanyRole(e){this.mainService.loadByParam(Object,this.CFGBUSINESS_FUNCTIONS_RESOURCE_NAME,e.id).subscribe(t=>{const s={};s.role=e,s.permits=t,this.selectedRoleClick.emit(s)},e=>{})}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(a.c),n.Mb(f.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-role-selector"]],inputs:{itemList:"itemList"},outputs:{selectedRoleClick:"selectedRoleClick"},decls:9,vars:1,consts:[[1,"container"],[1,"card"],[1,"card-header"],[1,"card-body","p-2"],[1,"list-group"],["type","button","class","list-group-item list-group-item-action ",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"card-footer"],["type","button",1,"list-group-item","list-group-item-action",3,"ngClass","click"],[1,"d-flex","flex-column"],[1,"d-flex"],[1,"font-weight-bold"],[1,"fas","fa-check"]],template:function(e,t){1&e&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Sb(2,"div",2),n.Sb(3,"h5"),n.Gc(4,"\u0421\u043f\u0438\u0441\u044a\u043a \u043d\u0430 \u0430\u0441\u043e\u0446\u0438\u0438\u0440\u0430\u043d\u0438\u0442\u0435 \u0440\u043e\u043b\u0438"),n.Rb(),n.Rb(),n.Sb(5,"div",3),n.Sb(6,"div",4),n.Ec(7,C,6,5,"button",5),n.Rb(),n.Rb(),n.Nb(8,"div",6),n.Rb(),n.Rb()),2&e&&(n.zb(7),n.mc("ngForOf",t.itemList))},directives:[i.t,i.r],styles:[""]}),e})();function T(e,t){if(1&e){const e=n.Tb();n.Sb(0,"app-organization-selector",3),n.ec("selectedOrgClick",(function(t){return n.wc(e),n.gc().onSelectedOrganizationClick(t)})),n.Rb()}if(2&e){const e=n.gc();n.mc("itemList",e.organizationList)}}function A(e,t){if(1&e){const e=n.Tb();n.Sb(0,"app-role-selector",4),n.ec("selectedRoleClick",(function(t){return n.wc(e),n.gc().onSelectedRoleClick(t)})),n.Rb()}if(2&e){const e=n.gc();n.mc("itemList",e.rolesList)}}let P=(()=>{class e{constructor(e,t,s,i,a,r,n){this.router=e,this.oidcSecurityService=t,this.mainService=s,this.sessInfoService=i,this.permissionsService=a,this.translate=r,this.lang=n,this.TRNUSERS_RESOURCE_NAME="TrnUsers",this.USER_INFO_RESOURCE_NAME=this.TRNUSERS_RESOURCE_NAME+"/getCurrentUserInfo",this.CERTIFICATE_RESOURCE_NAME="TrnDismantlingCenterStages/OrnId",this.LANG_BG="bg",this.organizationList=[],this.rolesList=[]}ngOnInit(){this.mainService.loadSingleObject(Object,this.USER_INFO_RESOURCE_NAME).subscribe(e=>{this.applyDefaultLang(),this.userType=e.flagIntOut,this.applyLoggedPerm();let t=[];null!=e.activeOrganizations&&(t=e.activeOrganizations.map(e=>{const t={};return Object.assign(t,e),t.isActive=!0,t.isSelected=!1,t}));let s=[];null!=e.notActiveOrganizations&&(s=e.notActiveOrganizations.map(e=>{const t={};return Object.assign(t,e),t.isActive=!1,t.isSelected=!1,t}));const i=t.concat(s),a=this.sessInfoService.getOrganization();if(null!=a){const e=i.find(e=>e.id===a.id);null!=e&&(e.isSelected=!0)}this.organizationList=i;const r=e.roles,n=this.sessInfoService.getRole();if(null!=n){const e=r.find(e=>e.id===n.id);null!=e&&(e.isSelected=!0)}this.rolesList=r,this.sessInfoService.saveUserInfo(e),this.sessInfoService.saveRiosv(e.rios)},e=>{})}onSelectedOrganizationClick(e){return Object(m.a)(this,void 0,void 0,(function*(){const t=yield this.checkCertificatePermitions(e.organization),s=e.permits;this.applyCertificatePermitions(t),this.sessInfoService.saveOrganization(e.organization),this.applyPermissions(s),this.router.navigate(["messages/home"])}))}onSelectedRoleClick(e){this.sessInfoService.saveRole(e.role),this.applyPermissions(e.permits),this.router.navigate(["messages/home"])}applyLoggedPerm(){const e=[p.a.IF_LOGGED];"E"===this.userType?e.push(p.a.IF_EXTERNAL):"I"===this.userType&&e.push(p.a.IF_INTERNAL),this.sessInfoService.savePermissions(e),this.permissionsService.loadPermissions(e)}applyPermissions(e){if(this.permissionsService.flushPermissions(),null==e)return;const t=this.sessInfoService.getPermissions();e.forEach(e=>{const s=e.name;e.businessFuncPrivs.forEach(e=>{t.push(s+"."+e.code)})}),this.sessInfoService.savePermissions(t),this.permissionsService.loadPermissions(t)}checkCertificatePermitions(e){return this.mainService.loadSingleObject(Object,this.CERTIFICATE_RESOURCE_NAME,e.id+"/authorized").toPromise()}applyCertificatePermitions(e){if(null==e)return;const t=this.sessInfoService.getPermissions();!0===e.payedTaxPermissions&&(this.permissionsService.addPermission(p.a.IF_PAYED_TAX),t.push(p.a.IF_PAYED_TAX)),!0===e.vehiclePermissions&&(this.permissionsService.addPermission(p.a.IF_VEHICLE_TAX),t.push(p.a.IF_VEHICLE_TAX)),this.sessInfoService.savePermissions(t)}applyDefaultLang(){this.translate.use(this.LANG_BG),this.lang.saveCurrentLang(this.LANG_BG)}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(a.c),n.Mb(S.d),n.Mb(f.a),n.Mb(v.a),n.Mb(R.d),n.Mb(l.e),n.Mb(M.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-login-page"]],decls:3,vars:3,consts:[[3,"showBtn"],[3,"itemList","selectedOrgClick",4,"ngIf"],[3,"itemList","selectedRoleClick",4,"ngIf"],[3,"itemList","selectedOrgClick"],[3,"itemList","selectedRoleClick"]],template:function(e,t){1&e&&(n.Nb(0,"app-subheader",0),n.Ec(1,T,1,1,"app-organization-selector",1),n.Ec(2,A,1,1,"app-role-selector",2)),2&e&&(n.mc("showBtn",!1),n.zb(1),n.mc("ngIf","E"===t.userType),n.zb(1),n.mc("ngIf","I"===t.userType))},directives:[o.a,i.u,w,y],styles:[""]}),e})();var F=s("aZ8m"),U=s("FYjP"),z=s("E9v4");let _=(()=>{class e{constructor(){this.isVisibleSideMenu=!0}ngOnInit(){}onSideMenuBtnChanged(e){this.isVisibleSideMenu=!this.isVisibleSideMenu}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Gb({type:e,selectors:[["app-auth-main-page"]],decls:4,vars:0,template:function(e,t){1&e&&(n.Nb(0,"app-header"),n.Nb(1,"router-outlet"),n.Nb(2,"app-alert"),n.Nb(3,"app-main-modal-spinner"))},directives:[F.a,a.h,U.a,z.a],styles:[""]}),e})();var k=s("cZd9");function B(e,t){if(1&e&&(n.Sb(0,"div",2),n.Nb(1,"app-sidebar-menu"),n.Rb()),2&e){const e=n.gc();n.mc("className",e.isVisibleSideMenu?"col-lg-2":"")}}let L=(()=>{class e{constructor(){this.isVisibleSideMenu=!0}ngOnInit(){}onSideMenuBtnChanged(e){this.isVisibleSideMenu=!this.isVisibleSideMenu}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Gb({type:e,selectors:[["app-profile-page"]],decls:5,vars:3,consts:[[1,"row","no-gutters"],[3,"className",4,"ngIf"],[3,"className"],[3,"defaultMenuItemId","menuBtnChanged"]],template:function(e,t){1&e&&(n.Sb(0,"div",0),n.Ec(1,B,2,1,"div",1),n.Sb(2,"div",2),n.Sb(3,"app-subheader",3),n.ec("menuBtnChanged",(function(e){return t.onSideMenuBtnChanged(e)})),n.Rb(),n.Nb(4,"router-outlet"),n.Rb(),n.Rb()),2&e&&(n.zb(1),n.mc("ngIf",t.isVisibleSideMenu),n.zb(1),n.mc("className",t.isVisibleSideMenu?"col-lg-10":"col-lg-12"),n.zb(1),n.mc("defaultMenuItemId",7))},directives:[i.u,o.a,a.h,k.a],styles:[""]}),e})();var x=s("L5DH"),j=s("Ki94"),G=s("zc99");let V=(()=>{class e{constructor(e){e&&(this.id=e.id,this.firstName=e.firstName,this.midName=e.midName,this.lastName=e.lastName,this.email=e.email,this.credentialType=G.a.adaptArray(e.credentialType,j.a))}get id(){return this.pId}set id(e){this.pId=e}get firstName(){return this.pFirstName}set firstName(e){this.pFirstName=e}get midName(){return this.pMidName}set midName(e){this.pMidName=e}get lastName(){return this.pLastName}set lastName(e){this.pLastName=e}get email(){return this.pEmail}set email(e){this.pEmail=e}get credentialType(){return this.pCredentialType}set credentialType(e){this.pCredentialType=e}get loginSign(){return this.pLoginSign}set loginSign(e){this.pLoginSign=e}get loginUserPass(){return this.pLoginUserPass}set loginUserPass(e){this.pLoginUserPass=e}get password(){return this.pPassword}set password(e){this.pPassword=e}get confirmPass(){return this.pConfirmPass}set confirmPass(e){this.pConfirmPass=e}}return e.url="TrnUsers",e})();var H=s("sGcX");function W(e,t){1&e&&(n.Sb(0,"div",7),n.Sb(1,"h6",8),n.Gc(2),n.hc(3,"translate"),n.Rb(),n.Rb()),2&e&&(n.zb(2),n.Hc(n.ic(3,1,"registration.data")))}function $(e,t){if(1&e&&n.Nb(0,"app-user-registration",10),2&e){const e=n.gc(2);n.mc("mode","E")("index","0")("model",e.model)("userData",e.userData)}}function K(e,t){if(1&e&&n.Ec(0,$,1,4,"app-user-registration",9),2&e){const e=n.gc();n.mc("ngIf",e.model)}}const X=function(){return["profile-data"]};let Z=(()=>{class e{constructor(e,t){this.crudService=e,this.mmSpinnerService=t}ngOnInit(){this.loadUserData()}loadUserData(){this.mmSpinnerService.showMainModalSpinner(),this.crudService.loadByParam(V,V.url,"getUserInfo").subscribe(e=>{e&&e.length>0&&(this.userData=e[0],this.loadRegModel(e[0])),this.mmSpinnerService.hideMainModalSpinner()},e=>{this.mmSpinnerService.hideMainModalSpinner()})}loadRegModel(e){const t=e.credentialType.find(e=>"E"===e.credType),s=e.credentialType.find(e=>"L"===e.credType),i=e.credentialType.find(e=>"U"===e.credType);this.model=new r.a({firstName:e.firstName,midName:e.midName,lastName:e.lastName,email:e.email,username:i?i.identifierNo:null,egn:t?t.identifierNo:null,lnch:s?s.identifierNo:null,loginSign:!(!t&&!s),loginUserPass:!!i})}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(f.a),n.Mb(H.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-user-profile"]],decls:10,vars:6,consts:[[1,"container-fluid","px-3"],[1,"text-center","my-4"],["id","accordion",3,"destroyOnHide","activeIds"],["acc","ngbAccordion"],["id","profile-data"],["ngbPanelHeader",""],["id","body","ngbPanelContent",""],[1,"d-flex","align-items-center","justify-content-between"],[1,"m-0"],[3,"mode","index","model","userData",4,"ngIf"],[3,"mode","index","model","userData"]],template:function(e,t){1&e&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Sb(2,"h4"),n.Gc(3),n.hc(4,"translate"),n.Rb(),n.Rb(),n.Sb(5,"ngb-accordion",2,3),n.Sb(7,"ngb-panel",4),n.Ec(8,W,4,3,"ng-template",5),n.Ec(9,K,1,1,"ng-template",6),n.Rb(),n.Rb(),n.Rb()),2&e&&(n.zb(3),n.Hc(n.ic(4,3,"registration.userProfile")),n.zb(2),n.mc("destroyOnHide",!1)("activeIds",n.pc(5,X)))},directives:[c.a,c.I,c.K,c.J,i.u,d.a],pipes:[l.d],styles:["[_nghost-%COMP%]     #accordion>div>div.card-header, [_nghost-%COMP%]     #accordion>div>div>div.card-body{padding:.5rem}"]}),e})();var q=s("bgjn"),J=s("lB+K"),Y=s("dEii"),Q=s("t9TW"),ee=s("XlQi");function te(e,t){if(1&e){const e=n.Tb();n.Sb(0,"app-individual-form",3),n.ec("cancel",(function(){return n.wc(e),n.gc().onCancel()})),n.Rb()}if(2&e){const e=n.gc();n.mc("model",e.model)("mode","E")}}function se(e,t){if(1&e){const e=n.Tb();n.Sb(0,"app-legal-entity-form",3),n.ec("cancel",(function(){return n.wc(e),n.gc().onCancel()})),n.Rb()}if(2&e){const e=n.gc();n.mc("model",e.model)("mode","E")}}let ie=(()=>{class e{constructor(e,t,s,i,a){this.crudService=e,this.mmSpinnerService=t,this.router=s,this.sessionService=i,this.alertService=a,this.usersLoader=new q.a(e)}ngOnInit(){const e=this.getOrgId();e?(this.mmSpinnerService.showMainModalSpinner(),this.usersLoader.loadData(e).then(e=>{this.model=e,this.orgType=this.model.org.indOrEntity,this.mmSpinnerService.hideMainModalSpinner()},e=>{this.mmSpinnerService.hideMainModalSpinner()})):this.alertService.error(J.a.NO_ORGANIZATION_ERROR,{})}onCancel(){this.router.navigate(["messages"])}getOrgId(){const e=this.sessionService.getOrganization();return e?e.id:null}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(f.a),n.Mb(H.a),n.Mb(a.c),n.Mb(v.a),n.Mb(Y.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-organization-profile"]],decls:7,vars:5,consts:[[1,"container-fluid","px-3"],[1,"text-center","my-4"],[3,"model","mode","cancel",4,"ngIf"],[3,"model","mode","cancel"]],template:function(e,t){1&e&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Sb(2,"h4"),n.Gc(3),n.hc(4,"translate"),n.Rb(),n.Rb(),n.Ec(5,te,1,2,"app-individual-form",2),n.Ec(6,se,1,2,"app-legal-entity-form",2),n.Rb()),2&e&&(n.zb(3),n.Hc(n.ic(4,3,"registration.organizationProfile")),n.zb(2),n.mc("ngIf","I"===t.orgType&&t.model),n.zb(1),n.mc("ngIf","E"===t.orgType&&t.model))},directives:[i.u,Q.a,ee.a],pipes:[l.d],styles:[""]}),e})();var ae=s("8Lb4"),re=s("8rWM"),ne=s("XDeO"),oe=s("hnrn");let ce=(()=>{class e{constructor(e){e&&(this.id=e.id,this.emailAddress=e.emailAddress,this.dateCreated=ne.a.getAnyAsTimestampModel(e.dateCreated),this.userCreated=e.userCreated,this.email=e.email,this.orgId=e.orgId)}get id(){return this.pId}set id(e){this.pId=e}get emailAddress(){return this.pEmailAddress}set emailAddress(e){this.pEmailAddress=e}get dateCreated(){return this.pDateCreated}set dateCreated(e){this.pDateCreated=e}get userCreated(){return this.pUserCreated}set userCreated(e){this.pUserCreated=e}get email(){return this.pEmail}set email(e){this.pEmail=e}get orgId(){return this.pOrgId}set orgId(e){this.pOrgId=e}}return e.urlByOrgId="TrnUserInvitations/getUserInvitationInfoById",e.urlSend="TrnUserInvitations/sendInvitation",Object(m.b)([Object(oe.b)({alias:"email"})],e.prototype,"pEmail",void 0),Object(m.b)([Object(oe.b)({alias:"orgId"})],e.prototype,"pOrgId",void 0),e})();var de=s("PSD3"),le=s.n(de),ge=s("BYCZ"),he=s("3Pt+"),be=s("lp4E"),ue=s("Ofwd"),me=s("c+ao"),pe=s("4AqF");function Se(e,t){if(1&e&&(n.Sb(0,"div",8),n.Sb(1,"h6",9),n.Gc(2),n.hc(3,"translate"),n.Rb(),n.Sb(4,"div"),n.Sb(5,"button",10),n.Nb(6,"i",11),n.Nb(7,"i",12),n.Rb(),n.Rb(),n.Rb()),2&e){n.gc();const e=n.vc(10);n.zb(2),n.Ic(" ",n.ic(3,3,"profile.invitation.sendHeader")," "),n.zb(4),n.mc("hidden",e.isExpanded("send")),n.zb(1),n.mc("hidden",!e.isExpanded("send"))}}function fe(e,t){if(1&e){const e=n.Tb();n.Sb(0,"form",13,14),n.Sb(2,"div",15),n.Sb(3,"div",16),n.Sb(4,"app-fi-input-email",17),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc().sendModel.email=t})),n.Rb(),n.Rb(),n.Sb(5,"div",16),n.Sb(6,"label"),n.Gc(7,"\xa0"),n.Rb(),n.Sb(8,"div",18),n.Sb(9,"button",19),n.ec("click",(function(){return n.wc(e),n.gc().onSend()})),n.Gc(10),n.hc(11,"translate"),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Rb()}if(2&e){const e=n.vc(1),t=n.gc();n.zb(4),n.mc("ngModel",t.sendModel.email)("formItemDef",t.formDefs[0])("name",t.formDefs[0].domName),n.zb(5),n.mc("disabled",!e.valid),n.zb(1),n.Ic(" ",n.ic(11,5,"profile.invitation.sendBtnLabel")," ")}}function ve(e,t){if(1&e&&(n.Sb(0,"div",8),n.Sb(1,"h6",9),n.Gc(2),n.hc(3,"translate"),n.Rb(),n.Sb(4,"div"),n.Sb(5,"button",10),n.Nb(6,"i",11),n.Nb(7,"i",12),n.Rb(),n.Rb(),n.Rb()),2&e){n.gc();const e=n.vc(10);n.zb(2),n.Ic(" ",n.ic(3,3,"profile.invitation.searchHeader")," "),n.zb(4),n.mc("hidden",e.isExpanded("search")),n.zb(1),n.mc("hidden",!e.isExpanded("search"))}}function Re(e,t){if(1&e){const e=n.Tb();n.Sb(0,"div",15),n.Sb(1,"div",20),n.Sb(2,"app-fi-input-date-period",17),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc().searchModel.period=t})),n.Rb(),n.Rb(),n.Sb(3,"div",16),n.Sb(4,"app-fi-input-email",17),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc().searchModel.email=t})),n.Rb(),n.Rb(),n.Rb(),n.Nb(5,"div",21),n.Sb(6,"app-search-and-navigation-bar",22),n.ec("clearEvent",(function(){return n.wc(e),n.gc().clearSearchFilters()}))("searchEvent",(function(t){return n.wc(e),n.gc().loadDataByFilter(t)}))("pageChangeEvent",(function(t){return n.wc(e),n.gc().loadDataByFilter(t)}))("rowPerPageChangeEvent",(function(t){return n.wc(e),n.gc().rowsPerPageChange(t)})),n.Rb(),n.Nb(7,"div",21),n.Sb(8,"app-data-viewer-as-table",23),n.ec("customRowEvent",(function(t){return n.wc(e),n.gc().reSend(t)})),n.Rb()}if(2&e){const e=n.gc();n.zb(2),n.mc("ngModel",e.searchModel.period)("formItemDef",e.formDefs[2])("name",e.formDefs[2].domName),n.zb(2),n.mc("ngModel",e.searchModel.email)("formItemDef",e.formDefs[1])("name",e.formDefs[1].domName),n.zb(2),n.mc("isFormValid",!0)("currentPage",e.data.pageWithOutOffset)("isPagingDisabled",!1)("totalRows",e.data.totalRows),n.zb(2),n.mc("columnDefItems",e.clms)("rowDataitems",e.data.pageContent)("showExportBtn",!1)("showTitleBar",!1)("showCustomBtn",!0)("customBtnDef",e.reSendBtnDef)}}const Me=function(){return["send","search"]};let Ie=(()=>{class e{constructor(e,t,s,i,a){this.generator=e,this.crudService=t,this.mmSpinnerService=s,this.sessionService=i,this.alertService=a,this.sendModel={},this.searchModel={},this.formDefs=[],this.data={},this.clms=[],this.hiddenClms=["pId","pEmail","pOrgId"],this.currentPageModel=new ae.a}ngOnInit(){this.formDefs=this.generator.getInvitationDefModel(),this.reSendBtnDef=this.generator.getReSendBtnDef(),this.getOrgId(),this.loadDataByFilter(this.currentPageModel)}onSend(){null!=this.orgId?this.sendInvitation(this.sendModel.email):this.alertService.error(J.a.NO_ORGANIZATION_ERROR,{})}reSend(e){null!=this.orgId?this.sendInvitation(e.emailAddress):this.alertService.error(J.a.NO_ORGANIZATION_ERROR,{})}clearSearchFilters(){this.searchModel={},this.currentPageModel.currentPage=0,this.loadDataByFilter(this.currentPageModel)}loadDataByFilter(e){if(this.currentPageModel=e,null==this.orgId)return void this.alertService.error(J.a.NO_ORGANIZATION_ERROR,{});this.mmSpinnerService.showMainModalSpinner();const t=Object.assign(Object.assign(Object.assign(Object.assign({},null!=this.searchModel.email&&{email:this.searchModel.email}),this.searchModel.period&&this.searchModel.period[0]&&{dateFrom:ne.a.getAnyAsTimestampModel(this.searchModel.period[0]).toString()}),this.searchModel.period&&this.searchModel.period[1]&&{dateTo:ne.a.getAnyAsTimestampModel(this.searchModel.period[1]).toString()}),{offset:e.currentPageWithOffset,size:e.rowsPerPage});this.crudService.loadPageContentWithOffsetAndSize(ce,`${ce.urlByOrgId}/${this.orgId}`,t).subscribe(e=>{this.data=e,this.data.pageContent=e.pageContent.sort((e,t)=>t.id-e.id),this.addDataToTable(),this.mmSpinnerService.hideMainModalSpinner()},e=>{this.mmSpinnerService.hideMainModalSpinner()})}rowsPerPageChange(e){this.currentPageModel.rowsPerPage=e,this.currentPageModel.currentPage=0,this.loadDataByFilter(this.currentPageModel)}addDataToTable(){this.clms=Object(re.a)(this.data.pageContent,this.clms,this.hiddenClms)}sendInvitation(e){this.crudService.saveData(ce.urlSend,new ce({email:e,orgId:this.orgId})).subscribe(e=>{le.a.fire({title:"\u041f\u043e\u043a\u0430\u043d\u0430\u0442\u0430 \u0431\u0435\u0448\u0435 \u0438\u0437\u043f\u0440\u0430\u0442\u0435\u043d\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e!",icon:"success"}).then(()=>{this.loadDataByFilter(this.currentPageModel),this.sendModel={}},e=>{var t;const s=null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message;this.alertService.error(s||J.a.TrnUserOrganization_addUserToOrganization_SAVE_ERROR,e)})})}getOrgId(){const e=this.sessionService.getOrganization();this.orgId=e?e.id:null}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(ge.a),n.Mb(f.a),n.Mb(H.a),n.Mb(v.a),n.Mb(Y.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-user-invitation"]],decls:17,vars:9,consts:[[1,"container-fluid","p-3"],[1,"text-center","mb-4"],["id","accordion",3,"destroyOnHide","activeIds"],["acc","ngbAccordion"],["id","send"],["ngbPanelHeader",""],["id","body","ngbPanelContent",""],["id","search"],[1,"d-flex","align-items-center","justify-content-between"],[1,"m-0"],["ngbPanelToggle","",1,"btn","btn-sm","btn-outline-secondary","rounded-circle"],[1,"fas","fa-chevron-right",3,"hidden"],[1,"fas","fa-chevron-down",3,"hidden"],["novalidate","",1,"was-validated"],["sendForm","ngForm"],[1,"row"],[1,"col-lg-4"],[3,"ngModel","formItemDef","name","ngModelChange"],[1,"d-flex","justify-content-start"],["type","button","ngbTooltip","\u0418\u0437\u043f\u0440\u0430\u0442\u0438","container","body",1,"btn","btn-outline-secondary",3,"disabled","click"],[1,"col-lg-8"],[1,"mt-1"],[3,"isFormValid","currentPage","isPagingDisabled","totalRows","clearEvent","searchEvent","pageChangeEvent","rowPerPageChangeEvent"],[3,"columnDefItems","rowDataitems","showExportBtn","showTitleBar","showCustomBtn","customBtnDef","customRowEvent"]],template:function(e,t){1&e&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Sb(2,"div"),n.Sb(3,"h4"),n.Gc(4),n.hc(5,"translate"),n.Rb(),n.Sb(6,"h6"),n.Gc(7),n.hc(8,"translate"),n.Rb(),n.Rb(),n.Rb(),n.Sb(9,"ngb-accordion",2,3),n.Sb(11,"ngb-panel",4),n.Ec(12,Se,8,5,"ng-template",5),n.Ec(13,fe,12,7,"ng-template",6),n.Rb(),n.Sb(14,"ngb-panel",7),n.Ec(15,ve,8,5,"ng-template",5),n.Ec(16,Re,9,16,"ng-template",6),n.Rb(),n.Rb(),n.Rb()),2&e&&(n.zb(4),n.Hc(n.ic(5,4,"profile.invitation.title")),n.zb(3),n.Hc(n.ic(8,6,"profile.invitation.subTitle")),n.zb(2),n.mc("destroyOnHide",!1)("activeIds",n.pc(8,Me)))},directives:[c.a,c.I,c.K,c.J,c.M,he.D,he.p,he.q,be.a,he.o,he.r,c.ab,ue.a,me.a,pe.a],pipes:[l.d],styles:["[_nghost-%COMP%]     #accordion>div>div.card-header, [_nghost-%COMP%]     #accordion>div>div>div.card-body{padding:.5rem}"]}),e})();var De=s("SkKo"),Ee=s("WCP0");let Oe=(()=>{class e{constructor(e){e&&(this.id=e.id,this.egn=e.egn,this.bulstat=e.bulstat,this.dateCreated=ne.a.getAnyAsTimestampModel(e.dateCreated),this.domain=e.domain,this.indOrEntity=e.indOrEntity,this.trnUserTypeDescription=e.trnUserTypeDescription,this.invStatusOrgDescription=e.invStatusOrgDescription+" - "+("Y"===e.isSigned?"\u0430\u043a\u0442\u0438\u0432\u043d\u0430":"\u043d\u0435\u0430\u043a\u0442\u0438\u0432\u043d\u0430"),this.name=e.name,this.email=e.email,this.orgUin=null==e.egn?e.bulstat:e.egn,this.trnUserOrgId=e.id,this.isSigned=e.isSigned)}get id(){return this.pId}set id(e){this.pId=e}get egn(){return this.pEgn}set egn(e){this.pEgn=e}get bulstat(){return this.pBulstat}set bulstat(e){this.pBulstat=e}get dateCreated(){return this.pDateCreated}set dateCreated(e){this.pDateCreated=e}get domain(){return this.pDomain}set domain(e){this.pDomain=e}get indOrEntity(){return this.pIndOrEntity}set indOrEntity(e){this.pIndOrEntity=e}get trnUserTypeDescription(){return this.pTrnUserTypeDescription}set trnUserTypeDescription(e){this.pTrnUserTypeDescription=e}get invStatusOrgDescription(){return this.pInvStatusOrgDescription}set invStatusOrgDescription(e){this.pInvStatusOrgDescription=e}get name(){return this.pName}set name(e){this.pName=e}get email(){return this.pEmail}set email(e){this.pEmail=e}get trnUserOrgId(){return this.pTrnUserOrgId}set trnUserOrgId(e){this.pTrnUserOrgId=e}get orgUin(){return this.pOrgUin}set orgUin(e){this.pOrgUin=e}get isSigned(){return this.pIsSigned}set isSigned(e){this.pIsSigned=e}}return e.url="TrnUserOrganization",e.param="getUserOrganizationInfo",e.changeMailUrl="TrnUserOrganization/updateWorkingEmail",Object(m.b)([Object(oe.b)({alias:"email"})],e.prototype,"pEmail",void 0),Object(m.b)([Object(oe.b)({alias:"trnUserOrgId"})],e.prototype,"pTrnUserOrgId",void 0),e})(),we=(()=>{class e{constructor(e){e&&(this.bulstat=e.bulstat,this.egn=e.egn,this.email=e.email,this.userTypeId=e.userTypeId)}get bulstat(){return this.pBulstat}set bulstat(e){this.pBulstat=e}get egn(){return this.pEgn}set egn(e){this.pEgn=e}get email(){return this.pEmail}set email(e){this.pEmail=e}get userTypeId(){return this.pUserTypeId}set userTypeId(e){this.pUserTypeId=e}}return e.url="TrnUserOrganization/addUserToOrganization",Object(m.b)([Object(oe.b)({alias:"bulstat"})],e.prototype,"pBulstat",void 0),Object(m.b)([Object(oe.b)({alias:"egn"})],e.prototype,"pEgn",void 0),Object(m.b)([Object(oe.b)({alias:"email"})],e.prototype,"pEmail",void 0),Object(m.b)([Object(oe.b)({alias:"userTypeId"})],e.prototype,"pUserTypeId",void 0),e})();var Ne=s("bYRt"),Ce=s("TTlI");const ye=["changeEmail"];function Te(e,t){if(1&e){const e=n.Tb();n.Sb(0,"div",14),n.Sb(1,"div",15),n.Sb(2,"small",16),n.Sb(3,"b"),n.Gc(4,"\u0413\u0440\u0435\u0448\u043a\u0430"),n.Rb(),n.Rb(),n.Sb(5,"button",17),n.ec("click",(function(){return n.wc(e),n.gc(2).removeAlert()})),n.Sb(6,"span",4),n.Gc(7,"\xd7"),n.Rb(),n.Rb(),n.Rb(),n.Sb(8,"small"),n.Gc(9),n.Rb(),n.Rb()}if(2&e){const e=n.gc(2);n.zb(9),n.Ic(" ",e.error," ")}}function Ae(e,t){if(1&e){const e=n.Tb();n.Sb(0,"div",1),n.Sb(1,"h4",2),n.Gc(2,"\u0420\u0435\u0434\u0430\u043a\u0446\u0438\u044f \u043d\u0430 \u0440\u0430\u0431\u043e\u0442\u0435\u043d \u0438\u043c\u0435\u0439\u043b"),n.Rb(),n.Sb(3,"button",3),n.ec("click",(function(){n.wc(e);const s=t.$implicit;return n.vc(9).reset(),s.dismiss("Cross click")})),n.Sb(4,"span",4),n.Gc(5,"\xd7"),n.Rb(),n.Rb(),n.Rb(),n.Sb(6,"div",5),n.Sb(7,"fieldset",6),n.Sb(8,"form",7,8),n.Sb(10,"app-fi-input-text",9),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc().model.uin=t})),n.Rb(),n.Sb(11,"app-fi-input-text",9),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc().model.name=t})),n.Rb(),n.Sb(12,"app-fi-input-text",9),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc().model.role=t})),n.Rb(),n.Sb(13,"app-fi-input-email",9),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc().model.email=t})),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Sb(14,"div",10),n.Sb(15,"div",11),n.Sb(16,"button",12),n.ec("click",(function(){n.wc(e);const t=n.vc(9);return n.gc().onSave(t)})),n.hc(17,"translate"),n.Gc(18),n.hc(19,"translate"),n.Rb(),n.Rb(),n.Ec(20,Te,10,1,"div",13),n.Rb()}if(2&e){const e=n.vc(9),t=n.gc();n.zb(7),n.mc("disabled",t.formDisabled),n.zb(3),n.mc("ngModel",t.model.uin)("formItemDef",t.formDefs[0])("name",t.formDefs[0].domName),n.zb(1),n.mc("ngModel",t.model.name)("formItemDef",t.formDefs[1])("name",t.formDefs[1].domName),n.zb(1),n.mc("ngModel",t.model.role)("formItemDef",t.formDefs[2])("name",t.formDefs[2].domName),n.zb(1),n.mc("ngModel",t.model.email)("formItemDef",t.formDefs[3])("name",t.formDefs[3].domName),n.zb(3),n.nc("ngbTooltip",n.ic(17,17,"buttons.saveChanges.tooltip")),n.mc("disabled",!e.valid||t.formDisabled),n.zb(2),n.Ic(" ",n.ic(19,19,"buttons.saveChanges.label")," "),n.zb(2),n.mc("ngIf",t.error)}}let Pe=(()=>{class e{constructor(e,t,s,i){this.modalService=e,this.alertService=t,this.generator=s,this.crudService=i,this.model={},this.formDefs=[],this.error=null,this.formDisabled=!1,this.reload=new n.n}ngOnInit(){this.formDefs=this.generator.getEditEmailDefModel()}openModal(e){this.removeAlert(),this.formDisabled=!1,this.model=e,this.modalReference=this.modalService.open(this.modal,{centered:!0,backdrop:"static",keyboard:!1})}onSave(e){this.formDisabled=!0,this.error=null,this.crudService.updateCurrentData(Oe.changeMailUrl,new Oe({email:this.model.email,id:this.model.id})).subscribe(t=>{this.reload.emit(!0),e.reset(),this.modalReference.close(),this.alertService.success(J.a.SUCCESS_MSG)},e=>{this.formDisabled=!1,this.error=J.a.CHANGE_WORK_EMAIL_ERROR})}removeAlert(){this.error=null}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(c.t),n.Mb(Y.a),n.Mb(ge.a),n.Mb(f.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-change-work-email-modal"]],viewQuery:function(e,t){var s;1&e&&n.Nc(ye,!0),2&e&&n.uc(s=n.fc())&&(t.modal=s.first)},outputs:{reload:"reload"},decls:2,vars:0,consts:[["changeEmail",""],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"disabled"],["novalidate","",1,"was-validated"],["form","ngForm"],[3,"ngModel","formItemDef","name","ngModelChange"],[1,"modal-footer","d-block"],[1,"d-flex","justify-content-end"],["type","button",1,"btn","btn-outline-secondary",3,"ngbTooltip","disabled","click"],["class","alert alert-danger alert-dismissable mx-0 my-2",4,"ngIf"],[1,"alert","alert-danger","alert-dismissable","mx-0","my-2"],[1,"d-flex","w-100","justify-content-between"],[1,"mb-1"],["type","button",1,"close",3,"click"]],template:function(e,t){1&e&&n.Ec(0,Ae,21,21,"ng-template",null,0,n.Fc)},directives:[he.D,he.p,he.q,Ce.a,he.o,he.r,be.a,c.ab,i.u],pipes:[l.d],styles:[""]}),e})(),Fe=(()=>{class e{constructor(e){e&&(this.roleId=e.roleId,this.trnUserOrgId=e.trnUserOrgId)}get roleId(){return this.pRoleId}set roleId(e){this.pRoleId=e}get trnUserOrgId(){return this.pTrnUserOrgId}set trnUserOrgId(e){this.pTrnUserOrgId=e}}return e.url="TrnUserOrganization/updateApplicationRole",Object(m.b)([Object(oe.b)({alias:"roleId"})],e.prototype,"pRoleId",void 0),Object(m.b)([Object(oe.b)({alias:"trnUserOrgId"})],e.prototype,"pTrnUserOrgId",void 0),e})();var Ue=s("Bz/w");const ze=["changeRole"];function _e(e,t){if(1&e){const e=n.Tb();n.Sb(0,"div",15),n.Sb(1,"div",16),n.Sb(2,"small",17),n.Sb(3,"b"),n.Gc(4,"\u0413\u0440\u0435\u0448\u043a\u0430"),n.Rb(),n.Rb(),n.Sb(5,"button",18),n.ec("click",(function(){return n.wc(e),n.gc(2).removeAlert()})),n.Sb(6,"span",4),n.Gc(7,"\xd7"),n.Rb(),n.Rb(),n.Rb(),n.Sb(8,"small"),n.Gc(9),n.Rb(),n.Rb()}if(2&e){const e=n.gc(2);n.zb(9),n.Ic(" ",e.error," ")}}function ke(e,t){if(1&e){const e=n.Tb();n.Sb(0,"div",1),n.Sb(1,"h4",2),n.Gc(2,"\u0420\u0435\u0434\u0430\u043a\u0446\u0438\u044f \u043d\u0430 \u0440\u043e\u043b\u044f"),n.Rb(),n.Sb(3,"button",3),n.ec("click",(function(){n.wc(e);const s=t.$implicit;return n.vc(9).reset(),s.dismiss("Cross click")})),n.Sb(4,"span",4),n.Gc(5,"\xd7"),n.Rb(),n.Rb(),n.Rb(),n.Sb(6,"div",5),n.Sb(7,"fieldset",6),n.Sb(8,"form",7,8),n.Sb(10,"app-fi-input-text",9),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc().model.uin=t})),n.Rb(),n.Sb(11,"app-fi-input-text",9),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc().model.name=t})),n.Rb(),n.Sb(12,"app-fi-select-dropdown",10),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc().model.role=t})),n.Rb(),n.Sb(13,"app-fi-input-email",9),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc().model.email=t})),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Sb(14,"div",11),n.Sb(15,"div",12),n.Sb(16,"button",13),n.ec("click",(function(){n.wc(e);const t=n.vc(9);return n.gc().onSave(t)})),n.hc(17,"translate"),n.Gc(18),n.hc(19,"translate"),n.Rb(),n.Rb(),n.Ec(20,_e,10,1,"div",14),n.Rb()}if(2&e){const e=n.vc(9),t=n.gc();n.zb(7),n.mc("disabled",t.formDisabled),n.zb(3),n.mc("ngModel",t.model.uin)("formItemDef",t.formDefs[0])("name",t.formDefs[0].domName),n.zb(1),n.mc("ngModel",t.model.name)("formItemDef",t.formDefs[1])("name",t.formDefs[1].domName),n.zb(1),n.mc("ngModel",t.model.role)("formItemDef",t.formDefs[2])("labelFieldName","description")("valueFieldName","id")("name",t.formDefs[2].domName),n.zb(1),n.mc("ngModel",t.model.email)("formItemDef",t.formDefs[3])("name",t.formDefs[3].domName),n.zb(3),n.nc("ngbTooltip",n.ic(17,19,"buttons.saveChanges.tooltip")),n.mc("disabled",!e.valid||t.formDisabled),n.zb(2),n.Ic(" ",n.ic(19,21,"buttons.saveChanges.label")," "),n.zb(2),n.mc("ngIf",t.error)}}let Be=(()=>{class e{constructor(e,t,s,i){this.modalService=e,this.alertService=t,this.generator=s,this.crudService=i,this.model={},this.formDefs=[],this.error=null,this.formDisabled=!1,this.reload=new n.n}ngOnInit(){this.formDefs=this.generator.getEditRoleDefModel(this.hasKep)}openModal(e){this.removeAlert(),this.formDisabled=!1,this.model=e,this.modalReference=this.modalService.open(this.modal,{centered:!0,backdrop:"static",keyboard:!1})}onSave(e){this.formDisabled=!0,this.error=null,this.crudService.updateCurrentData(Fe.url,new Fe({roleId:this.model.role,trnUserOrgId:this.model.id})).subscribe(t=>{this.reload.emit(!0),e.reset(),this.modalReference.close(),this.alertService.success(J.a.SUCCESS_MSG)},e=>{this.formDisabled=!1,this.error=J.a.CHANGE_ROLE_ERROR})}removeAlert(){this.error=null}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(c.t),n.Mb(Y.a),n.Mb(ge.a),n.Mb(f.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-change-role-modal"]],viewQuery:function(e,t){var s;1&e&&n.Nc(ze,!0),2&e&&n.uc(s=n.fc())&&(t.modal=s.first)},inputs:{hasKep:"hasKep"},outputs:{reload:"reload"},decls:2,vars:0,consts:[["changeRole",""],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"disabled"],["novalidate","",1,"was-validated"],["form","ngForm"],[3,"ngModel","formItemDef","name","ngModelChange"],[3,"ngModel","formItemDef","labelFieldName","valueFieldName","name","ngModelChange"],[1,"modal-footer","d-block"],[1,"d-flex","justify-content-end"],["type","button",1,"btn","btn-outline-secondary",3,"ngbTooltip","disabled","click"],["class","alert alert-danger alert-dismissable mx-0 my-2",4,"ngIf"],[1,"alert","alert-danger","alert-dismissable","mx-0","my-2"],[1,"d-flex","w-100","justify-content-between"],[1,"mb-1"],["type","button",1,"close",3,"click"]],template:function(e,t){1&e&&n.Ec(0,ke,21,23,"ng-template",null,0,n.Fc)},directives:[he.D,he.p,he.q,Ce.a,he.o,he.r,Ue.a,be.a,c.ab,i.u],pipes:[l.d],styles:[""]}),e})();var Le=s("MxKE"),xe=s("s2+o"),je=s("oqUd");const Ge=["editEmailModal"],Ve=["editRoleModal"];function He(e,t){if(1&e&&(n.Sb(0,"div",12),n.Sb(1,"h6",13),n.Gc(2," \u0418\u0417\u041f\u0420\u0410\u0429\u0410\u041d\u0415 \u041d\u0410 \u041c\u041e\u041b\u0411\u0410 \u0417\u0410 \u0412\u041a\u041b\u042e\u0427\u0412\u0410\u041d\u0415 \u0412 \u0415\u041a\u0418\u041f "),n.Rb(),n.Sb(3,"div"),n.Sb(4,"button",14),n.Nb(5,"i",15),n.Nb(6,"i",16),n.Rb(),n.Rb(),n.Rb()),2&e){n.gc();const e=n.vc(6);n.zb(5),n.mc("hidden",e.isExpanded("send")),n.zb(1),n.mc("hidden",!e.isExpanded("send"))}}function We(e,t){if(1&e){const e=n.Tb();n.Sb(0,"div",27),n.Sb(1,"app-fi-input-uin",28),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc(2).model.uin=t}))("valueEmitter",(function(){return n.wc(e),n.gc(2).onSearchChange()}))("searchEmitter",(function(){return n.wc(e),n.gc(2).onSearchIndividual()})),n.Rb(),n.Rb()}if(2&e){const e=n.gc(2);n.zb(1),n.mc("ngModel",e.model.uin)("formItemDef",e.formDefs[1])("name",e.formDefs[1].domName)("isSearchable",!0)}}function $e(e,t){if(1&e){const e=n.Tb();n.Sb(0,"div",27),n.Sb(1,"app-fi-input-eik",29),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc(2).model.eik=t}))("valueEmitter",(function(){return n.wc(e),n.gc(2).onSearchChange()}))("searchEmitter",(function(){return n.wc(e),n.gc(2).onSearchLegalEntity()})),n.Rb(),n.Rb()}if(2&e){const e=n.gc(2);n.zb(1),n.mc("ngModel",e.model.eik)("formItemDef",e.formDefs[2])("name",e.formDefs[2].domName)("isSearchable",!0)("showValidationCheck",!0)}}function Ke(e,t){if(1&e){const e=n.Tb();n.Sb(0,"div",27),n.Sb(1,"app-fi-select-dropdown",30),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc(2).model.role=t})),n.Rb(),n.Rb()}if(2&e){const e=n.gc(2);n.zb(1),n.mc("ngModel",e.model.role)("formItemDef",e.formDefs[5])("labelFieldName","description")("valueFieldName","id")("name",e.formDefs[5].domName)}}function Xe(e,t){if(1&e){const e=n.Tb();n.Sb(0,"div",27),n.Sb(1,"app-fi-input-email",31),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc(2).model.email=t})),n.Rb(),n.Rb()}if(2&e){const e=n.gc(2);n.zb(1),n.mc("ngModel",e.model.email)("formItemDef",e.formDefs[4])("name",e.formDefs[4].domName)}}function Ze(e,t){if(1&e&&(n.Sb(0,"span"),n.Gc(1),n.Rb()),2&e){const e=n.gc(2);n.zb(1),n.Ic(" ",e.searchResultText," ")}}function qe(e,t){if(1&e){const e=n.Tb();n.Sb(0,"button",32),n.ec("click",(function(){return n.wc(e),n.gc(2).onSave()})),n.Gc(1," \u0418\u0437\u043f\u0440\u0430\u0442\u0438 \u043c\u043e\u043b\u0431\u0430 "),n.Rb()}if(2&e){n.gc();const e=n.vc(1),t=n.gc();n.mc("disabled",!e.valid||!t.selectedType||!t.searchResult)}}function Je(e,t){if(1&e){const e=n.Tb();n.Sb(0,"form",17,18),n.Sb(2,"h6",19),n.Gc(3),n.hc(4,"translate"),n.Rb(),n.Sb(5,"div",20),n.Sb(6,"div",21),n.Sb(7,"app-fi-input-radio-group",22),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc().model.orgType=t}))("valueEmitter",(function(t){return n.wc(e),n.gc().onRadioChange(t)})),n.Rb(),n.Rb(),n.Rb(),n.Sb(8,"div",20),n.Ec(9,We,2,4,"div",23),n.Ec(10,$e,2,5,"div",23),n.Ec(11,Ke,2,5,"div",23),n.Ec(12,Xe,2,3,"div",23),n.Rb(),n.Sb(13,"div",24),n.Sb(14,"div"),n.Ec(15,Ze,2,1,"span",25),n.Rb(),n.Ec(16,qe,2,1,"button",26),n.Rb(),n.Rb()}if(2&e){const e=n.gc();n.zb(3),n.Ic(" ",n.ic(4,13,"applications.debtors.search.debtorType")," "),n.zb(4),n.mc("source",e.orgTypes)("ngModel",e.model.orgType)("formItemDef",e.formDefs[0])("name",e.formDefs[0].domName)("labelFieldName","description")("valueFieldName","code"),n.zb(2),n.mc("ngIf","I"===e.selectedType),n.zb(1),n.mc("ngIf","E"===e.selectedType),n.zb(1),n.mc("ngIf",e.selectedType&&e.searchResult),n.zb(1),n.mc("ngIf",e.selectedType&&e.searchResult),n.zb(3),n.mc("ngIf",e.searchResultText),n.zb(1),n.mc("ngIf",e.selectedType&&e.searchResult)}}function Ye(e,t){if(1&e&&(n.Sb(0,"div",12),n.Sb(1,"h6",13),n.Gc(2," \u0415\u041a\u0418\u041f\u0418 "),n.Rb(),n.Sb(3,"div"),n.Sb(4,"button",14),n.Nb(5,"i",15),n.Nb(6,"i",16),n.Rb(),n.Rb(),n.Rb()),2&e){n.gc();const e=n.vc(6);n.zb(5),n.mc("hidden",e.isExpanded("teams")),n.zb(1),n.mc("hidden",!e.isExpanded("teams"))}}function Qe(e,t){if(1&e){const e=n.Tb();n.Sb(0,"app-search-and-navigation-bar",33),n.ec("pageChangeEvent",(function(t){return n.wc(e),n.gc().loadData(t)}))("rowPerPageChangeEvent",(function(t){return n.wc(e),n.gc().rowsPerPageChange(t)})),n.Rb(),n.Nb(1,"div",34),n.Sb(2,"app-data-viewer-as-table",35),n.ec("customRowEvent",(function(t){return n.wc(e),n.gc().onEditMail(t)})),n.Rb()}if(2&e){const e=n.gc();n.mc("isFormValid",!0)("currentPage",e.data.pageWithOutOffset)("isPagingDisabled",!1)("totalRows",e.data.totalRows)("showSearchBtns",!1),n.zb(2),n.mc("columnDefItems",e.clms)("rowDataitems",e.data.pageContent)("showExportBtn",!1)("showTitleBar",!1)("showCustomBtn",!0)("customBtnDef",e.editEmailBtnDef)}}const et=function(){return["send","teams"]};let tt=(()=>{class e{constructor(e,t,s,i,a){this.generator=e,this.crudService=t,this.mmSpinnerService=s,this.sessionService=i,this.alertService=a,this.model={},this.formDefs=[],this.orgTypes=[],this.searchResult=!1,this.searchResultText=null,this.data={},this.clms=[],this.hiddenClms=["pId","pDomain","pBulstat","pDateCreated","pEgn","pIndOrEntity","pTrnUserOrgId","pIsSigned"],this.currentPageModel=new ae.a}ngOnInit(){this.loadTypes();const e=this.sessionService.getUserInfo();this.hasKep=!!e&&e.hasKep,this.formDefs=this.generator.getUserOrgAccessDefModel(this.hasKep),this.editEmailBtnDef=this.generator.getEditEmailBtnDef(),this.loadData(this.currentPageModel)}get selectedType(){return this.model.orgType?this.model.orgType.code:null}onRadioChange(e){this.searchResultText=null,this.searchResult=!1,"I"===e.code&&(this.model.eik=null,this.model.leName=null),"E"===e.code&&(this.model.uin=null)}onSearchIndividual(){null!=this.model.uin&&(this.searchResult=!1,this.searchResultText=null,this.model.role=null,this.model.email=null,this.crudService.loadByParamsInArray(Boolean,Ee.a.urlGetByEgnBulstat,`egn=${this.model.uin}`).subscribe(e=>{this.searchResult=!!(e&&e.length>0)&&e[0].valueOf(),this.resultMsg()}))}onSearchLegalEntity(){null!=this.model.eik&&(this.searchResult=!1,this.searchResultText=null,this.model.role=null,this.model.email=null,this.crudService.loadByParamsInArray(Boolean,Ee.a.urlGetByEgnBulstat,`bulstat=${this.model.eik}`).subscribe(e=>{this.searchResult=!!(e&&e.length>0)&&e[0].valueOf(),this.resultMsg()}))}onSearchChange(){this.searchResult=!1,this.searchResultText=null,this.model.role=null,this.model.email=null}onSave(){this.crudService.saveData(we.url,new we({bulstat:this.model.eik,egn:this.model.uin,email:this.model.email,userTypeId:this.model.role})).subscribe(e=>{le.a.fire({title:"\u041c\u043e\u043b\u0431\u0430\u0442\u0430 \u0437\u0430 \u0432\u043a\u043b\u044e\u0447\u0432\u0430\u043d\u0435 \u0432 \u0435\u043a\u0438\u043f \u0431\u0435\u0448\u0435 \u0438\u0437\u043f\u0440\u0430\u0442\u0435\u043d\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e!",icon:"success"}).then(()=>{this.loadData(this.currentPageModel),this.model={}})},e=>{var t;const s=null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message;this.alertService.error(s||J.a.TrnUserOrganization_addUserToOrganization_SAVE_ERROR,e)})}onEditMail(e){e.id&&this.crudService.loadById(Ne.a,Ne.a.url,e.id).subscribe(t=>{"01"===t.status&&(console.log(t),this.changeRoleModal.openModal({id:e.id,name:e.name,uin:null==e.egn?e.bulstat:e.egn,role:t.roleId,email:e.email})),"02"===t.status&&this.changeEmailModal.openModal({id:e.id,name:e.name,uin:null==e.egn?e.bulstat:e.egn,role:e.trnUserTypeDescription,email:e.email})})}onEmailChanged(){this.loadData(this.currentPageModel)}loadData(e){this.currentPageModel=e,this.mmSpinnerService.showMainModalSpinner(),this.crudService.loadByParamInPaging(Oe,Oe.url,Oe.param,e.currentPageWithOffset,e.rowsPerPage).subscribe(e=>{this.data=e,this.addDataToTable(),this.mmSpinnerService.hideMainModalSpinner()},e=>{this.mmSpinnerService.hideMainModalSpinner()})}rowsPerPageChange(e){this.currentPageModel.rowsPerPage=e,this.currentPageModel.currentPage=0,this.loadData(this.currentPageModel)}addDataToTable(){this.clms=Object(re.a)(this.data.pageContent,this.clms,this.hiddenClms)}loadTypes(){this.crudService.loadByParam(De.a,De.a.publicUrlDomain,"IND_OR_ENT").subscribe(e=>{this.orgTypes=e})}resultMsg(){this.searchResultText=this.searchResult?'\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u0441 \u043f\u043e\u0441\u043e\u0447\u0435\u043d\u0438\u0442\u0435 \u0444\u0438\u043b\u0442\u0440\u0438 \u0437\u0430 \u0442\u044a\u0440\u0441\u0435\u043d\u0435 \u0435 \u043d\u0430\u043b\u0438\u0447\u043d\u0430 \u0432 \u041d\u0418\u0421\u041e.\n        \u0417\u0430 \u0434\u0430 \u043f\u043e\u0434\u0430\u0434\u0435\u0442\u0435 \u043c\u043e\u043b\u0431\u0430 \u0437\u0430 \u0432\u043a\u043b\u044e\u0447\u0432\u0430\u043d\u0435 \u0432 \u0435\u043f\u043a\u0438\u043f, \u043f\u043e\u043f\u044a\u043b\u043d\u0435\u0442\u0435 \u0437\u0430\u0434\u044a\u043b\u0436\u0438\u0442\u0435\u043b\u043d\u0438\u0442\u0435 \u043f\u043e\u043b\u0435\u0442\u0430 \u0438 \u0438\u0437\u0431\u0435\u0440\u0435\u0442\u0435 \u0431\u0443\u0442\u043e\u043d "\u0418\u0437\u043f\u0440\u0430\u0442\u0438 \u043c\u043e\u043b\u0431\u0430".':'\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u0441 \u043f\u043e\u0441\u043e\u0447\u0435\u043d\u0438\u0442\u0435 \u0444\u0438\u043b\u0442\u0440\u0438 \u0437\u0430 \u0442\u044a\u0440\u0441\u0435\u043d\u0435 \u043d\u0435 \u0435 \u043d\u0430\u043b\u0438\u0447\u043d\u0430 \u0432 \u041d\u0418\u0421\u041e.\n        \u041c\u043e\u043b\u0431\u0430 \u0437\u0430 \u0432\u043a\u043b\u044e\u0447\u0432\u0430\u043d\u0435 \u0432 \u0435\u043a\u0438\u043f \u043d\u0435 \u0441\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0432\u0430.\n        \u0417\u0430 \u0434\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0430\u0442\u0435 \u0437\u0430\u0434\u044a\u043b\u0436\u0435\u043d\u043e \u043b\u0438\u0446\u0435, \u0438\u0437\u0431\u0435\u0440\u0435\u0442\u0435 \u043c\u0435\u043d\u044e "\u0417\u0430\u044f\u0432\u043b\u0435\u043d\u0438\u044f" -> \u0417\u0430\u044f\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043d\u0430 \u0437\u0430\u0434\u044a\u043b\u0436\u0435\u043d\u043e \u043b\u0438\u0446\u0435.'}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(ge.a),n.Mb(f.a),n.Mb(H.a),n.Mb(v.a),n.Mb(Y.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-user-org-access"]],viewQuery:function(e,t){var s;1&e&&(n.Nc(Ge,!0),n.Nc(Ve,!0)),2&e&&(n.uc(s=n.fc())&&(t.changeEmailModal=s.first),n.uc(s=n.fc())&&(t.changeRoleModal=s.first))},decls:17,vars:4,consts:[[1,"container-fluid","p-3"],[1,"text-center","mb-4"],["id","accordion",3,"destroyOnHide","activeIds"],["acc","ngbAccordion"],["id","send"],["ngbPanelHeader",""],["id","body","ngbPanelContent",""],["id","teams"],[3,"reload"],["editEmailModal",""],[3,"hasKep","reload"],["editRoleModal",""],[1,"d-flex","align-items-center","justify-content-between"],[1,"m-0"],["ngbPanelToggle","",1,"btn","btn-sm","btn-outline-secondary","rounded-circle"],[1,"fas","fa-chevron-right",3,"hidden"],[1,"fas","fa-chevron-down",3,"hidden"],["novalidate","",1,"was-validated"],["form","ngForm"],[1,"mb-3"],[1,"row"],[1,"col-lg-4"],[3,"source","ngModel","formItemDef","name","labelFieldName","valueFieldName","ngModelChange","valueEmitter"],["class","col-lg-3",4,"ngIf"],[1,"d-flex","justify-content-between"],[4,"ngIf"],["type","button","class","btn btn-outline-secondary","container","body",3,"disabled","click",4,"ngIf"],[1,"col-lg-3"],[3,"ngModel","formItemDef","name","isSearchable","ngModelChange","valueEmitter","searchEmitter"],[3,"ngModel","formItemDef","name","isSearchable","showValidationCheck","ngModelChange","valueEmitter","searchEmitter"],[3,"ngModel","formItemDef","labelFieldName","valueFieldName","name","ngModelChange"],[3,"ngModel","formItemDef","name","ngModelChange"],["type","button","container","body",1,"btn","btn-outline-secondary",3,"disabled","click"],[3,"isFormValid","currentPage","isPagingDisabled","totalRows","showSearchBtns","pageChangeEvent","rowPerPageChangeEvent"],[1,"mt-1"],[3,"columnDefItems","rowDataitems","showExportBtn","showTitleBar","showCustomBtn","customBtnDef","customRowEvent"]],template:function(e,t){1&e&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Sb(2,"div"),n.Sb(3,"h4"),n.Gc(4,"\u041c\u041e\u041b\u0411\u0410 \u0417\u0410 \u0412\u041a\u041b\u042e\u0427\u0412\u0410\u041d\u0415 \u0412 \u0415\u041a\u0418\u041f"),n.Rb(),n.Rb(),n.Rb(),n.Sb(5,"ngb-accordion",2,3),n.Sb(7,"ngb-panel",4),n.Ec(8,He,7,2,"ng-template",5),n.Ec(9,Je,17,15,"ng-template",6),n.Rb(),n.Sb(10,"ngb-panel",7),n.Ec(11,Ye,7,2,"ng-template",5),n.Ec(12,Qe,3,11,"ng-template",6),n.Rb(),n.Rb(),n.Rb(),n.Sb(13,"app-change-work-email-modal",8,9),n.ec("reload",(function(){return t.onEmailChanged()})),n.Rb(),n.Sb(15,"app-change-role-modal",10,11),n.ec("reload",(function(){return t.onEmailChanged()})),n.Rb()),2&e&&(n.zb(5),n.mc("destroyOnHide",!1)("activeIds",n.pc(3,et)),n.zb(10),n.mc("hasKep",t.hasKep))},directives:[c.a,c.I,c.K,c.J,Pe,Be,c.M,he.D,he.p,he.q,Le.a,he.o,he.r,i.u,xe.a,je.a,Ue.a,be.a,me.a,pe.a],pipes:[l.d],styles:["[_nghost-%COMP%]     #accordion>div>div.card-header, [_nghost-%COMP%]     #accordion>div>div>div.card-body{padding:.5rem}"]}),e})();var st=s("/iu+"),it=s("c1MP");function at(e,t){1&e&&(n.Sb(0,"div",9),n.Sb(1,"h6",10),n.Gc(2," \u0422\u042a\u0420\u0421\u0415\u041d\u0415 \u041d\u0410 \u041c\u041e\u041b\u0411\u0410 "),n.Rb(),n.Rb())}function rt(e,t){if(1&e){const e=n.Tb();n.Sb(0,"div",11),n.Sb(1,"div",12),n.Sb(2,"app-fi-input-text",13),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc(2).searchModel.fName=t})),n.Rb(),n.Rb(),n.Sb(3,"div",12),n.Sb(4,"app-fi-input-text",13),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc(2).searchModel.mName=t})),n.Rb(),n.Rb(),n.Sb(5,"div",12),n.Sb(6,"app-fi-input-text",13),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc(2).searchModel.lName=t})),n.Rb(),n.Rb(),n.Rb(),n.Sb(7,"div",11),n.Sb(8,"div",12),n.Sb(9,"app-fi-select-dropdown",14),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc(2).searchModel.role=t})),n.Rb(),n.Rb(),n.Sb(10,"div",12),n.Sb(11,"app-fi-select-dropdown",14),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc(2).searchModel.status=t})),n.Rb(),n.Rb(),n.Sb(12,"div",12),n.Sb(13,"app-fi-input-date-period",13),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc(2).searchModel.period=t})),n.Rb(),n.Rb(),n.Rb(),n.Nb(14,"div",15),n.Sb(15,"app-search-and-navigation-bar",16),n.ec("clearEvent",(function(){return n.wc(e),n.gc(2).clearSearchFilters()}))("searchEvent",(function(t){return n.wc(e),n.gc(2).loadDataByFilter(t)}))("pageChangeEvent",(function(t){return n.wc(e),n.gc(2).loadDataByFilter(t)}))("rowPerPageChangeEvent",(function(t){return n.wc(e),n.gc(2).rowsPerPageChange(t)})),n.Rb(),n.Nb(16,"div",15),n.Sb(17,"app-data-viewer-as-table",17),n.ec("customRowEvent",(function(t){return n.wc(e),n.gc(2).onEdit(t)})),n.Rb()}if(2&e){const e=n.gc(2);n.zb(2),n.mc("ngModel",e.searchModel.fName)("formItemDef",e.formDefs[0])("name",e.formDefs[0].domName),n.zb(2),n.mc("ngModel",e.searchModel.mName)("formItemDef",e.formDefs[1])("name",e.formDefs[1].domName),n.zb(2),n.mc("ngModel",e.searchModel.lName)("formItemDef",e.formDefs[2])("name",e.formDefs[2].domName),n.zb(3),n.mc("ngModel",e.searchModel.role)("formItemDef",e.formDefs[3])("labelFieldName","description")("valueFieldName","name")("name",e.formDefs[3].domName),n.zb(2),n.mc("ngModel",e.searchModel.status)("formItemDef",e.formDefs[4])("labelFieldName","description")("valueFieldName","code")("name",e.formDefs[4].domName),n.zb(2),n.mc("ngModel",e.searchModel.period)("formItemDef",e.formDefs[5])("name",e.formDefs[5].domName),n.zb(2),n.mc("isFormValid",!0)("currentPage",e.data.pageWithOutOffset)("isPagingDisabled",!1)("totalRows",e.data.totalRows),n.zb(2),n.mc("columnDefItems",e.clms)("rowDataitems",e.data.pageContent)("showExportBtn",!1)("showTitleBar",!1)("showCustomBtn",!0)("customBtnDef",e.editBtnDef)}}function nt(e,t){1&e&&(n.Sb(0,"ngb-panel",6),n.Ec(1,at,3,0,"ng-template",7),n.Ec(2,rt,18,32,"ng-template",8),n.Rb())}function ot(e,t){1&e&&(n.Sb(0,"div",9),n.Sb(1,"h6",10),n.Gc(2," \u041f\u0420\u0415\u0413\u041b\u0415\u0414 \u0418 \u041e\u0411\u0420\u0410\u0411\u041e\u0422\u041a\u0410 \u041d\u0410 \u041c\u041e\u041b\u0411\u0410 "),n.Rb(),n.Rb())}function ct(e,t){if(1&e){const e=n.Tb();n.Sb(0,"app-user-org-rel",19),n.ec("cancel",(function(){return n.wc(e),n.gc(2).onCancelForm()}))("updated",(function(){return n.wc(e),n.gc(2).onSuccUpdate()})),n.Rb()}if(2&e){const e=n.gc(2);n.mc("model",e.editModel)}}function dt(e,t){1&e&&(n.Sb(0,"ngb-panel",18),n.Ec(1,ot,3,0,"ng-template",7),n.Ec(2,ct,1,1,"ng-template",8),n.Rb())}const lt=function(){return["search","edit"]};let gt=(()=>{class e{constructor(e,t,s,i,a){this.generator=e,this.mmSpinnerService=t,this.crudService=s,this.sessionService=i,this.alertService=a,this.isFormVisible=!1,this.editModel={},this.searchModel={},this.formDefs=[],this.data={},this.clms=[],this.hiddenClms=["pId","pRoleId","pIsSelected","pStatusCode","pUserId","pIsSigned"],this.currentPageModel=new ae.a}ngOnInit(){this.formDefs=this.generator.getMngUserOrgAccDefModel(),this.editBtnDef=this.generator.getEditAccessBtnDef(),this.getOrgId(),this.loadDataByFilter(this.currentPageModel)}clearSearchFilters(){this.searchModel={},this.currentPageModel.currentPage=0,this.loadDataByFilter(this.currentPageModel)}loadDataByFilter(e){if(this.currentPageModel=e,null==this.orgId)return void this.alertService.error(J.a.NO_ORGANIZATION_ERROR,{});this.mmSpinnerService.showMainModalSpinner();const t=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.searchModel.period&&this.searchModel.period[0]&&{dateFrom:ne.a.getAnyAsTimestampModel(this.searchModel.period[0]).toString()}),this.searchModel.period&&this.searchModel.period[1]&&{dateTo:ne.a.getAnyAsTimestampModel(this.searchModel.period[1]).toString()}),null!=this.searchModel.fName&&{firstName:this.searchModel.fName}),null!=this.searchModel.mName&&{midName:this.searchModel.mName}),null!=this.searchModel.lName&&{lastName:this.searchModel.lName}),null!=this.searchModel.status&&{state:this.searchModel.status}),null!=this.searchModel.role&&{role:this.searchModel.role}),{orgId:this.orgId,offset:e.currentPageWithOffset,size:e.rowsPerPage});this.crudService.loadPageContentWithOffsetAndSize(st.a,st.a.url,t).subscribe(e=>{this.data=e,this.addDataToTable(),this.mmSpinnerService.hideMainModalSpinner()},e=>{this.mmSpinnerService.hideMainModalSpinner()})}rowsPerPageChange(e){this.currentPageModel.rowsPerPage=e,this.currentPageModel.currentPage=0,this.loadDataByFilter(this.currentPageModel)}onEdit(e){this.editModel=e,this.isFormVisible=!0}onCancelForm(){this.editModel=null,this.isFormVisible=!1,this.currentPageModel.currentPage=0,this.loadDataByFilter(this.currentPageModel)}onSuccUpdate(){this.currentPageModel.currentPage=0,this.loadDataByFilter(this.currentPageModel)}addDataToTable(){this.clms=Object(re.a)(this.data.pageContent,this.clms,this.hiddenClms)}getOrgId(){const e=this.sessionService.getOrganization();this.orgId=e?e.id:null}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(ge.a),n.Mb(H.a),n.Mb(f.a),n.Mb(v.a),n.Mb(Y.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-mng-user-org-access"]],decls:9,vars:5,consts:[[1,"container-fluid","p-3"],[1,"text-center","mb-4"],["id","accordion",3,"destroyOnHide","activeIds"],["acc","ngbAccordion"],["id","search",4,"ngIf"],["id","edit",4,"ngIf"],["id","search"],["ngbPanelHeader",""],["id","body","ngbPanelContent",""],[1,"d-flex","align-items-center","justify-content-between"],[1,"m-0"],[1,"row"],[1,"col-lg-4"],[3,"ngModel","formItemDef","name","ngModelChange"],[3,"ngModel","formItemDef","labelFieldName","valueFieldName","name","ngModelChange"],[1,"mt-1"],[3,"isFormValid","currentPage","isPagingDisabled","totalRows","clearEvent","searchEvent","pageChangeEvent","rowPerPageChangeEvent"],[3,"columnDefItems","rowDataitems","showExportBtn","showTitleBar","showCustomBtn","customBtnDef","customRowEvent"],["id","edit"],[3,"model","cancel","updated"]],template:function(e,t){1&e&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Sb(2,"div"),n.Sb(3,"h4"),n.Gc(4,"\u041c\u041e\u041b\u0411\u0418 \u0417\u0410 \u0412\u041a\u041b\u042e\u0427\u0412\u0410\u041d\u0415 \u0412 \u0415\u041a\u0418\u041f"),n.Rb(),n.Rb(),n.Rb(),n.Sb(5,"ngb-accordion",2,3),n.Ec(7,nt,3,0,"ngb-panel",4),n.Ec(8,dt,3,0,"ngb-panel",5),n.Rb(),n.Rb()),2&e&&(n.zb(5),n.mc("destroyOnHide",!1)("activeIds",n.pc(4,lt)),n.zb(2),n.mc("ngIf",!t.isFormVisible),n.zb(1),n.mc("ngIf",t.isFormVisible))},directives:[c.a,i.u,c.I,c.K,c.J,Ce.a,he.o,he.r,Ue.a,ue.a,me.a,pe.a,it.a],styles:["[_nghost-%COMP%]     #accordion>div>div.card-header, [_nghost-%COMP%]     #accordion>div>div>div.card-body{padding:.5rem}"]}),e})(),ht=(()=>{class e{constructor(e){e&&(this.id=e.id,this.authNum=e.authNum,this.code=e.code)}get id(){return this.pId}set id(e){this.pId=e}get authNum(){return this.pAuthNum}set authNum(e){this.pAuthNum=e}get code(){return this.pCode}set code(e){this.pCode=e}get label(){return`\u2116 ${this.pAuthNum?this.pAuthNum:""} (${this.code})`}}return e.url="TrnAuthorizations/getAuthorizations",e})(),bt=(()=>{class e{constructor(e){this.APP_OTHER_CODE="OTHER",this.APP_TR_CODE="TR",this.APP_BR_CODE="BR",e&&(this.id=e.id,this.terName=e.terName,this.distName=e.distName,this.popName=e.popName,this.address=e.address,this.opCode=e.opCode,this.permitStage=e.permitStage,this.authNum=e.authNum,this.stageLabel=this.getStageLabel(),this.userAuthStageId=e.userAuthStageId),this.isSelected=!1}get id(){return this.pId}set id(e){this.pId=e}get address(){return this.pAddress}set address(e){this.pAddress=e}get opCode(){return this.pOpCode}set opCode(e){this.pOpCode=e}get permitStage(){return this.pPermitStage}set permitStage(e){this.pPermitStage=e}get isSelected(){return this.pIsSelected}set isSelected(e){this.pIsSelected=e}get popName(){return this.pPopName}set popName(e){this.pPopName=e}get authNum(){return this.p\u0410uthNum}set authNum(e){this.p\u0410uthNum=e}get stageLabel(){return this.pStageLabel}set stageLabel(e){this.pStageLabel=e}getStageLabel(){switch(this.opCode){case this.APP_OTHER_CODE:return`${this.popName} - ${this.address}. ${this.p\u0410uthNum?this.p\u0410uthNum:""} ${this.permitStage?this.permitStage:""}`;case this.APP_BR_CODE:return"\u041f\u043b\u043e\u0449\u0430\u0434\u043a\u0430 - \u0422\u044a\u0440\u0433\u043e\u0432\u0435\u0446";case this.APP_TR_CODE:return"\u041f\u043b\u043e\u0449\u0430\u0434\u043a\u0430 - \u0411\u0440\u043e\u043a\u0435\u0440";default:return`${this.id}`}}get userAuthStageId(){return this.pUserAuthStageId}set userAuthStageId(e){this.pUserAuthStageId=e}get distName(){return this.pDistName}set distName(e){this.pDistName=e}get terName(){return this.pTerName}set terName(e){this.pTerName=e}}return e.linkedUrl="TrnUserOrganization/getStagesForOrganizationAndUsersLinked",e.notLinkedUrl="TrnUserOrganization/getStagesForOrganizationAndUsersNotLinked",e})(),ut=(()=>{class e{constructor(e){Object.assign(this,e||{})}get authStageId(){return this.pAuthStageId}set authStageId(e){this.pAuthStageId=e}get orgId(){return this.pOrgId}set orgId(e){this.pOrgId=e}get userId(){return this.pUserId}set userId(e){this.pUserId=e}get dateFrom(){return this.pDateFrom}set dateFrom(e){this.pDateFrom=e}}return e.url="TrnUserAuthStages",Object(m.b)([Object(oe.b)({alias:"authStageId"})],e.prototype,"pAuthStageId",void 0),Object(m.b)([Object(oe.b)({alias:"orgId"})],e.prototype,"pOrgId",void 0),Object(m.b)([Object(oe.b)({alias:"userId"})],e.prototype,"pUserId",void 0),Object(m.b)([Object(oe.b)({alias:"dateFrom"})],e.prototype,"pDateFrom",void 0),e})();var mt=s("wt70"),pt=s("lz7R");function St(e,t){if(1&e){const e=n.Tb();n.Sb(0,"div",11),n.Sb(1,"div",12),n.Sb(2,"app-data-viewer-as-table",13),n.ec("selectedRowEvent",(function(t){return n.wc(e),n.gc().onStageSelected(t)})),n.Rb(),n.Rb(),n.Sb(3,"div",14),n.Sb(4,"div",15),n.Sb(5,"div",16),n.Sb(6,"button",17),n.ec("click",(function(){return n.wc(e),n.gc().showAlert("ADD_ALL")})),n.Nb(7,"i",18),n.Rb(),n.Sb(8,"button",19),n.ec("click",(function(){return n.wc(e),n.gc().showAlert("ADD_SEL")})),n.Nb(9,"i",20),n.Rb(),n.Sb(10,"button",21),n.ec("click",(function(){return n.wc(e),n.gc().showAlert("DEL_SEL")})),n.Nb(11,"i",22),n.Rb(),n.Sb(12,"button",23),n.ec("click",(function(){return n.wc(e),n.gc().showAlert("DEL_ALL")})),n.Nb(13,"i",24),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Sb(14,"div",12),n.Sb(15,"app-data-viewer-as-table",13),n.ec("selectedRowEvent",(function(t){return n.wc(e),n.gc().onUserStageSelected(t)})),n.Rb(),n.Rb(),n.Rb()}if(2&e){const e=n.gc();n.zb(2),n.mc("objectPrefix","aun-orn-stages")("columnDefItems",e.orgStagesClms)("rowDataitems",e.orgStages.pageContent)("showExportBtn",!1)("showTitleBar",!0)("showSelectBtn",!0),n.zb(4),n.mc("disabled",null==e.orgStages||null==e.orgStages.pageContent||0===e.orgStages.pageContent.length),n.zb(2),n.mc("disabled",null==e.stagesToAdd||0===e.stagesToAdd.length),n.zb(2),n.mc("disabled",null==e.stagesForDelete||0===e.stagesForDelete.length),n.zb(2),n.mc("disabled",null==e.userStages||null==e.userStages.pageContent||0===e.userStages.pageContent.length),n.zb(3),n.mc("objectPrefix","aun-user-stages")("columnDefItems",e.userStagesClms)("rowDataitems",e.userStages.pageContent)("showExportBtn",!1)("showTitleBar",!0)("showSelectBtn",!0)}}let ft=(()=>{class e{constructor(e,t,s,i){this.generator=e,this.alertService=t,this.crudService=s,this.mmSpinnerService=i,this.RED="#dc3545",this.WARNING="warning",this.SUCCESS="success",this.auths=[],this.orgSearchDisable=!0,this.userSearchDisable=!0,this.searchOrgStagesModel={},this.orgStageFormDefs=[],this.orgStages={},this.orgStagesClms=[],this.searchUserStagesModel={},this.userStageFormDefs=[],this.userStages={},this.userStagesClms=[],this.stagesHiddenClms=["pId","pIsSelected","pOpCode","APP_OTHER_CODE","APP_TR_CODE","APP_BR_CODE","pUserAuthStageId","pStageLabel"],this.stagesForDelete=[],this.stagesToAdd=[],this.userPageModel=new ae.a,this.orgPageModel=new ae.a}set selectedUser(e){this.selectedUserId=null==e?void 0:e.userId,this.selectedUserName=(null==e?void 0:e.firstName)+" "+(null==e?void 0:e.lastName),this.stagesToAdd=[],this.stagesForDelete=[],this.auths=[],this.orgStages={},this.userStages={},this.searchOrgStagesModel={},this.searchUserStagesModel={},this.selectedUserId&&(this.loadAuths(),this.loadOrgStagesByFilter(this.orgPageModel),this.loadUserStagesByFilter(this.userPageModel))}ngOnInit(){this.orgStageFormDefs=this.generator.getSearchStageDefModel(),this.userStageFormDefs=this.generator.getSearchStageDefModel()}onStageSelected(e){null!=e&&(e.isSelected?this.stagesToAdd.push(e.id):this.stagesToAdd=this.stagesToAdd.filter(t=>t!==e.id))}onUserStageSelected(e){null!=e&&(e.isSelected?this.stagesForDelete.push(e.userAuthStageId):this.stagesForDelete=this.stagesForDelete.filter(t=>t!==e.userAuthStageId))}onOrgAuthChange(e){!e||"T"!==e.code&&"B"!==e.code&&"TB"!==e.code?this.changeSerchFormDefs(this.orgStageFormDefs,!1):(this.searchOrgStagesModel&&(this.searchOrgStagesModel.terCode=null,this.searchOrgStagesModel.distEknm=null,this.searchOrgStagesModel.popEknm=null),this.changeSerchFormDefs(this.orgStageFormDefs,!0))}onUserAuthChange(e){!e||"T"!==e.code&&"B"!==e.code&&"TB"!==e.code?this.changeSerchFormDefs(this.userStageFormDefs,!1):(this.searchUserStagesModel&&(this.searchUserStagesModel.terCode=null,this.searchUserStagesModel.distEknm=null,this.searchUserStagesModel.popEknm=null),this.changeSerchFormDefs(this.userStageFormDefs,!0))}clearOrgStagesSearchFilters(){this.searchOrgStagesModel={},this.orgPageModel.currentPage=0,this.loadOrgStagesByFilter(this.orgPageModel)}loadOrgStagesByFilter(e){if(this.orgPageModel=e,null==this.orgId)return void this.alertService.error(J.a.NO_ORGANIZATION_ERROR,{});if(null==this.selectedUserId)return void this.alertService.error(J.a.NO_USER_ERROR,{});this.mmSpinnerService.showMainModalSpinner();const t=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},null!=this.searchOrgStagesModel.popEknm&&{popEknm:this.searchOrgStagesModel.popEknm}),null!=this.searchOrgStagesModel.auth&&{aunId:this.searchOrgStagesModel.auth}),null!=this.searchOrgStagesModel.address&&{address:this.searchOrgStagesModel.address}),null!=this.searchOrgStagesModel.terCode&&{terCode:this.searchOrgStagesModel.terCode}),null!=this.searchOrgStagesModel.distEknm&&{distEknm:this.searchOrgStagesModel.distEknm}),null!=this.searchOrgStagesModel.permitStage&&{permitStage:this.searchOrgStagesModel.permitStage}),{offset:e.currentPageWithOffset,size:e.rowsPerPage});this.crudService.loadPageContentWithOffsetAndSize(bt,`${bt.notLinkedUrl}/${this.orgId}/${this.selectedUserId}`,t).subscribe(e=>{this.orgStages=e,this.addDataToTable("O"),this.mmSpinnerService.hideMainModalSpinner()},e=>{this.mmSpinnerService.hideMainModalSpinner()})}orgRowsChange(e){this.orgPageModel.rowsPerPage=e,this.orgPageModel.currentPage=0,this.loadOrgStagesByFilter(this.orgPageModel)}clearUserStagesSearchFilters(){this.searchUserStagesModel={},this.userPageModel.currentPage=0,this.loadUserStagesByFilter(this.userPageModel)}loadUserStagesByFilter(e){if(this.userPageModel=e,null==this.orgId)return void this.alertService.error(J.a.NO_ORGANIZATION_ERROR,{});if(null==this.selectedUserId)return void this.alertService.error(J.a.NO_USER_ERROR,{});this.mmSpinnerService.showMainModalSpinner();const t=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},null!=this.searchUserStagesModel.popEknm&&{popEknm:this.searchUserStagesModel.popEknm}),null!=this.searchUserStagesModel.auth&&{aunId:this.searchUserStagesModel.auth}),null!=this.searchUserStagesModel.address&&{address:this.searchUserStagesModel.address}),null!=this.searchOrgStagesModel.terCode&&{terCode:this.searchOrgStagesModel.terCode}),null!=this.searchOrgStagesModel.distEknm&&{distEknm:this.searchOrgStagesModel.distEknm}),null!=this.searchOrgStagesModel.permitStage&&{permitStage:this.searchOrgStagesModel.permitStage}),{offset:e.currentPageWithOffset,size:e.rowsPerPage});this.crudService.loadPageContentWithOffsetAndSize(bt,`${bt.linkedUrl}/${this.orgId}/${this.selectedUserId}`,t).subscribe(e=>{this.userStages=e,this.addDataToTable("U"),this.mmSpinnerService.hideMainModalSpinner()},e=>{this.mmSpinnerService.hideMainModalSpinner()})}userRowsChange(e){this.userPageModel.rowsPerPage=e,this.userPageModel.currentPage=0,this.loadUserStagesByFilter(this.userPageModel)}showAlert(e){const t=this.getTitle(e),s=this.getText(e),i=this.getFooter(e);le.a.fire({title:t,text:s,icon:this.WARNING,footer:i,showConfirmButton:!0,confirmButtonText:J.a.CONFIRM_BUTTON_TEXT,showCancelButton:!0,cancelButtonText:J.a.CANCEL_BUTTON_TEXT,cancelButtonColor:this.RED,allowOutsideClick:!1}).then(t=>{t.isConfirmed&&this.doWork(e)})}getTitle(e){let t="";switch(e){case"ADD_ALL":case"ADD_SEL":t=J.a.TITLE_USER_STAGE_ADD;break;case"DEL_ALL":case"DEL_SEL":t=J.a.TITLE_USER_STAGE_DELETE}return t}getText(e){let t="";switch(e){case"ADD_ALL":case"ADD_SEL":t=J.a.TEXT_USER_STAGE_ADD;break;case"DEL_ALL":case"DEL_SEL":t=J.a.TEXT_USER_STAGE_DELETE}return t}getFooter(e){const t=this.selectedUserName;let s=0;switch(e){case"ADD_ALL":s=this.orgStages.pageContent?this.orgStages.pageContent.length:0;break;case"ADD_SEL":s=this.stagesToAdd?this.stagesToAdd.length:0;break;case"DEL_ALL":s=this.userStages.pageContent?this.userStages.pageContent.length:0;break;case"DEL_SEL":s=this.stagesForDelete?this.stagesForDelete.length:0}return`\u041f\u043e\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043b: ${t}. \u0418\u0437\u0431\u0440\u0430\u043d\u0438 \u043f\u043b\u043e\u0449\u0430\u0434\u043a\u0438: ${s}.`}addDataToTable(e){switch(e){case"D":break;case"O":this.orgStagesClms=Object(re.a)(this.orgStages.pageContent,this.orgStagesClms,this.stagesHiddenClms);break;case"U":this.userStagesClms=Object(re.a)(this.userStages.pageContent,this.userStagesClms,this.stagesHiddenClms)}}loadAuths(){this.crudService.loadByParam(ht,ht.url,this.orgId).subscribe(e=>{this.auths=e})}addUserStageRel(){if(null==this.orgId)return void this.alertService.error(J.a.NO_ORGANIZATION_ERROR,{});if(null==this.selectedUserId)return void this.alertService.error(J.a.NO_USER_ERROR,{});if(null==this.stagesToAdd||0===this.stagesToAdd.length)return void this.alertService.error(J.a.NO_STAGE_ERROR,{});const e=this.stagesToAdd.map(e=>{const t=new mt.a(ne.a.getNowAsNgbDateStruct());return new ut({authStageId:e,userId:this.selectedUserId,orgId:this.orgId,dateFrom:t})});return this.crudService.createMany(ut.url,e).subscribe(e=>{this.stagesToAdd=[],this.loadOrgStagesByFilter(this.orgPageModel),this.loadUserStagesByFilter(this.userPageModel)})}deleteUserStageRel(){if(null!=this.stagesForDelete&&0!==this.stagesForDelete.length)return this.crudService.deleteMany(ut.url,this.stagesForDelete).subscribe(e=>{this.stagesForDelete=[],this.loadOrgStagesByFilter(this.orgPageModel),this.loadUserStagesByFilter(this.userPageModel)});this.alertService.error(J.a.NO_STAGE_ERROR,{})}changeSerchFormDefs(e,t){for(let s=1;s<e.length;s++)e[s].readonly=t,e[s].isDisabled=t}doWork(e){switch(e){case"ADD_ALL":this.onInsertAllStages();break;case"ADD_SEL":this.onInsertStages();break;case"DEL_ALL":this.onDeleteAllStages();break;case"DEL_SEL":this.onDeleteStages()}}onInsertAllStages(){this.stagesToAdd=[],this.stagesToAdd=this.orgStages.pageContent.map(e=>e.id),this.addUserStageRel()}onInsertStages(){this.addUserStageRel()}onDeleteStages(){this.deleteUserStageRel()}onDeleteAllStages(){this.stagesForDelete=[],this.stagesForDelete=this.userStages.pageContent.map(e=>e.userAuthStageId),this.deleteUserStageRel()}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(ge.a),n.Mb(Y.a),n.Mb(f.a),n.Mb(H.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-aun-user-stages"]],inputs:{orgId:"orgId",selectedUser:"selectedUser"},decls:41,vars:57,consts:[[1,"container-fluid"],[1,"row"],[1,"col-lg-6"],[1,"col-lg-12"],[3,"ngModel","formItemDef","labelFieldName","valueFieldName","name","externalDataItems","ngModelChange","valueEmitter"],[1,"col-lg-4"],[3,"ngModel","formItemDef","labelFieldName","valueFieldName","name","ngModelChange"],[3,"ngModel","formItemDef","name","ngModelChange"],[1,"mt-1"],[3,"isFormValid","currentPage","isPagingDisabled","totalRows","clearEvent","searchEvent","pageChangeEvent","rowPerPageChangeEvent"],["class","row mt-2",4,"ngIf"],[1,"row","mt-2"],[1,"col-lg-5"],[3,"objectPrefix","columnDefItems","rowDataitems","showExportBtn","showTitleBar","showSelectBtn","selectedRowEvent"],[1,"col-lg-2"],[1,"d-flex","justify-content-center","align-items-end","h-100"],["role","group",1,"btn-group-vertical"],["type","button","placement","left","ngbTooltip","\u0410\u0446\u043e\u0446\u0438\u0438\u0440\u0430\u043d\u0435 \u043d\u0430 \u0432\u0441\u0438\u0447\u043a\u0438 \u043f\u043b\u043e\u0449\u0430\u0434\u043a\u0438","container","body",1,"btn","btn-outline-secondary","mb-1",3,"disabled","click"],[1,"fas","fa-angle-double-right"],["type","button","ngbTooltip","\u0410\u0446\u043e\u0446\u0438\u0438\u0440\u0430\u043d\u0435 \u043d\u0430 \u0438\u0437\u0431\u0440\u0430\u043d\u0438\u0442\u0435 \u043f\u043b\u043e\u0449\u0430\u0434\u043a\u0438","container","body",1,"btn","btn-outline-secondary","mb-1",3,"disabled","click"],[1,"fas","fa-angle-right"],["type","button","ngbTooltip","\u041f\u0440\u0435\u043a\u0440\u0430\u0442\u044f\u0432\u0430\u043d\u0435 \u043d\u0430 \u0434\u043e\u0441\u0442\u044a\u043f\u0430 \u0434\u043e \u0438\u0437\u0431\u0440\u0430\u043d\u0438\u0442\u0435 \u043f\u043b\u043e\u0449\u0430\u0434\u043a\u0438","container","body",1,"btn","btn-outline-secondary","mb-1",3,"disabled","click"],[1,"fas","fa-angle-left"],["type","button","ngbTooltip","\u041f\u0440\u0435\u043a\u0440\u0430\u0442\u044f\u0432\u0430\u043d\u0435 \u043d\u0430 \u0434\u043e\u0441\u0442\u044a\u043f\u0430 \u0434\u043e \u0432\u0441\u0438\u0447\u043a\u0438 \u043f\u043b\u043e\u0449\u0430\u0434\u043a\u0438","container","body",1,"btn","btn-outline-secondary","mb-1",3,"disabled","click"],[1,"fas","fa-angle-double-left"]],template:function(e,t){1&e&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Sb(2,"div",2),n.Sb(3,"h5"),n.Gc(4,"\u0412\u0441\u0438\u0447\u043a\u0438 \u043f\u043b\u043e\u0449\u0430\u0434\u043a\u0438"),n.Rb(),n.Nb(5,"hr"),n.Sb(6,"div",1),n.Sb(7,"div",3),n.Sb(8,"app-fi-select-dropdown",4),n.ec("ngModelChange",(function(e){return t.searchOrgStagesModel.auth=e}))("valueEmitter",(function(e){return t.onOrgAuthChange(e)})),n.Rb(),n.Rb(),n.Rb(),n.Sb(9,"div",1),n.Sb(10,"div",5),n.Sb(11,"app-fi-select-dropdown-cascade",6),n.ec("ngModelChange",(function(e){return t.searchOrgStagesModel.terCode=e})),n.Rb(),n.Rb(),n.Sb(12,"div",5),n.Sb(13,"app-fi-select-dropdown-cascade",6),n.ec("ngModelChange",(function(e){return t.searchOrgStagesModel.distEknm=e})),n.Rb(),n.Rb(),n.Sb(14,"div",5),n.Sb(15,"app-fi-select-dropdown-cascade",6),n.ec("ngModelChange",(function(e){return t.searchOrgStagesModel.popEknm=e})),n.Rb(),n.Rb(),n.Rb(),n.Sb(16,"div",1),n.Sb(17,"div",3),n.Sb(18,"app-fi-input-text",7),n.ec("ngModelChange",(function(e){return t.searchOrgStagesModel.address=e})),n.Rb(),n.Rb(),n.Rb(),n.Nb(19,"div",8),n.Sb(20,"app-search-and-navigation-bar",9),n.ec("clearEvent",(function(){return t.clearOrgStagesSearchFilters()}))("searchEvent",(function(e){return t.loadOrgStagesByFilter(e)}))("pageChangeEvent",(function(e){return t.loadOrgStagesByFilter(e)}))("rowPerPageChangeEvent",(function(e){return t.orgRowsChange(e)})),n.Rb(),n.Rb(),n.Sb(21,"div",2),n.Sb(22,"h5"),n.Gc(23,"\u0410\u0441\u043e\u0446\u0438\u0438\u0440\u0430\u043d\u0438 \u043f\u043b\u043e\u0449\u0430\u0434\u043a\u0438"),n.Rb(),n.Nb(24,"hr"),n.Sb(25,"div",1),n.Sb(26,"div",3),n.Sb(27,"app-fi-select-dropdown",4),n.ec("ngModelChange",(function(e){return t.searchUserStagesModel.auth=e}))("valueEmitter",(function(e){return t.onUserAuthChange(e)})),n.Rb(),n.Rb(),n.Rb(),n.Sb(28,"div",1),n.Sb(29,"div",5),n.Sb(30,"app-fi-select-dropdown-cascade",6),n.ec("ngModelChange",(function(e){return t.searchUserStagesModel.terCode=e})),n.Rb(),n.Rb(),n.Sb(31,"div",5),n.Sb(32,"app-fi-select-dropdown-cascade",6),n.ec("ngModelChange",(function(e){return t.searchUserStagesModel.distEknm=e})),n.Rb(),n.Rb(),n.Sb(33,"div",5),n.Sb(34,"app-fi-select-dropdown-cascade",6),n.ec("ngModelChange",(function(e){return t.searchUserStagesModel.popEknm=e})),n.Rb(),n.Rb(),n.Rb(),n.Sb(35,"div",1),n.Sb(36,"div",3),n.Sb(37,"app-fi-input-text",7),n.ec("ngModelChange",(function(e){return t.searchUserStagesModel.address=e})),n.Rb(),n.Rb(),n.Rb(),n.Nb(38,"div",8),n.Sb(39,"app-search-and-navigation-bar",9),n.ec("clearEvent",(function(){return t.clearUserStagesSearchFilters()}))("searchEvent",(function(e){return t.loadUserStagesByFilter(e)}))("pageChangeEvent",(function(e){return t.loadUserStagesByFilter(e)}))("rowPerPageChangeEvent",(function(e){return t.userRowsChange(e)})),n.Rb(),n.Rb(),n.Rb(),n.Ec(40,St,16,16,"div",10),n.Rb()),2&e&&(n.zb(8),n.mc("ngModel",t.searchOrgStagesModel.auth)("formItemDef",t.orgStageFormDefs[0])("labelFieldName","authNum")("valueFieldName","id")("name",t.orgStageFormDefs[0].domName)("externalDataItems",t.auths),n.zb(3),n.mc("ngModel",t.searchOrgStagesModel.terCode)("formItemDef",t.orgStageFormDefs[1])("labelFieldName","terName")("valueFieldName","terCode")("name",t.orgStageFormDefs[1].domName),n.zb(2),n.mc("ngModel",t.searchOrgStagesModel.distEknm)("formItemDef",t.orgStageFormDefs[2])("labelFieldName","distName")("valueFieldName","distEknm")("name",t.orgStageFormDefs[2].domName),n.zb(2),n.mc("ngModel",t.searchOrgStagesModel.popEknm)("formItemDef",t.orgStageFormDefs[3])("labelFieldName","popName")("valueFieldName","popEknm")("name",t.orgStageFormDefs[3].domName),n.zb(3),n.mc("ngModel",t.searchOrgStagesModel.address)("formItemDef",t.orgStageFormDefs[4])("name",t.orgStageFormDefs[4].domName),n.zb(2),n.mc("isFormValid",!0)("currentPage",t.orgStages.pageWithOutOffset)("isPagingDisabled",!1)("totalRows",t.orgStages.totalRows),n.zb(7),n.mc("ngModel",t.searchUserStagesModel.auth)("formItemDef",t.userStageFormDefs[0])("labelFieldName","authNum")("valueFieldName","id")("name",t.userStageFormDefs[0].domName)("externalDataItems",t.auths),n.zb(3),n.mc("ngModel",t.searchUserStagesModel.terCode)("formItemDef",t.userStageFormDefs[1])("labelFieldName","terName")("valueFieldName","terCode")("name",t.userStageFormDefs[1].domName),n.zb(2),n.mc("ngModel",t.searchUserStagesModel.distEknm)("formItemDef",t.userStageFormDefs[2])("labelFieldName","distName")("valueFieldName","distEknm")("name",t.userStageFormDefs[2].domName),n.zb(2),n.mc("ngModel",t.searchUserStagesModel.popEknm)("formItemDef",t.userStageFormDefs[3])("labelFieldName","popName")("valueFieldName","popEknm")("name",t.userStageFormDefs[3].domName),n.zb(3),n.mc("ngModel",t.searchUserStagesModel.address)("formItemDef",t.userStageFormDefs[4])("name",t.userStageFormDefs[4].domName),n.zb(2),n.mc("isFormValid",!0)("currentPage",t.userStages.pageWithOutOffset)("isPagingDisabled",!1)("totalRows",t.userStages.totalRows),n.zb(1),n.mc("ngIf",t.orgStages.pageContent&&t.orgStages.pageContent.length||t.userStages.pageContent&&t.userStages.pageContent.length))},directives:[Ue.a,he.o,he.r,pt.a,Ce.a,me.a,i.u,pe.a,c.ab],styles:[""]}),e})(),vt=(()=>{class e{constructor(e){e&&(this.id=e.id,this.ewc=e.ewc)}get id(){return this.pId}set id(e){this.pId=e}get ewc(){return this.pEwc}set ewc(e){this.pEwc=e}}return e.url="TrnWorksheets/getWorksheetsUserHaveAccess",e})(),Rt=(()=>{class e{constructor(e){e&&(this.id=e.id,this.terName=e.terName,this.distName=e.distName,this.popName=e.popName,this.address=e.address,this.permitStage=e.permitStage,this.userAuthStageId=e.userAuthStageId,this.ewc=e.ewc,this.dateCreated=ne.a.getAnyAsTimestampModel(e.dateCreated),this.wotData=`${this.ewc}/${ne.a.getSrvModelAsStringDate(this.dateCreated)}`),this.isSelected=!1}get id(){return this.pId}set id(e){this.pId=e}get address(){return this.pAddress}set address(e){this.pAddress=e}get permitStage(){return this.pPermitStage}set permitStage(e){this.pPermitStage=e}get isSelected(){return this.pIsSelected}set isSelected(e){this.pIsSelected=e}get popName(){return this.pPopName}set popName(e){this.pPopName=e}get userAuthStageId(){return this.pUserAuthStageId}set userAuthStageId(e){this.pUserAuthStageId=e}get distName(){return this.pDistName}set distName(e){this.pDistName=e}get ewc(){return this.pEwc}set ewc(e){this.pEwc=e}get dateCreated(){return this.pDateCreated}set dateCreated(e){this.pDateCreated=e}get wotData(){return this.pWotData}set wotData(e){this.pWotData=e}get terName(){return this.pTerName}set terName(e){this.pTerName=e}}return e.linkedUrl="TrnWorksheets/getStagesForOrganizationAndUserLinked",e.notLinkedUrl="TrnWorksheets/getStagesForOrganizationAndUserNotLinked",e})();class Mt{constructor(e){e&&(this.id=e.id,this.terName=e.terName,this.distName=e.distName,this.popName=e.popName,this.address=e.address,this.permitStage=e.permitStage,this.userAuthStageId=e.userAuthStageId),this.isSelected=!1}get id(){return this.pId}set id(e){this.pId=e}get address(){return this.pAddress}set address(e){this.pAddress=e}get permitStage(){return this.pPermitStage}set permitStage(e){this.pPermitStage=e}get isSelected(){return this.pIsSelected}set isSelected(e){this.pIsSelected=e}get popName(){return this.pPopName}set popName(e){this.pPopName=e}get userAuthStageId(){return this.pUserAuthStageId}set userAuthStageId(e){this.pUserAuthStageId=e}get distName(){return this.pDistName}set distName(e){this.pDistName=e}get terName(){return this.pTerName}set terName(e){this.pTerName=e}get wotData(){return this.pWotData}set wotData(e){this.pWotData=e}}function It(e,t){if(1&e){const e=n.Tb();n.Sb(0,"div",11),n.Sb(1,"div",12),n.Sb(2,"app-data-viewer-as-table",13),n.ec("selectedRowEvent",(function(t){return n.wc(e),n.gc().onStageSelected(t)})),n.Rb(),n.Rb(),n.Sb(3,"div",14),n.Sb(4,"div",15),n.Sb(5,"div",16),n.Sb(6,"button",17),n.ec("click",(function(){return n.wc(e),n.gc().showAlert("ADD_ALL")})),n.Nb(7,"i",18),n.Rb(),n.Sb(8,"button",19),n.ec("click",(function(){return n.wc(e),n.gc().showAlert("ADD_SEL")})),n.Nb(9,"i",20),n.Rb(),n.Sb(10,"button",21),n.ec("click",(function(){return n.wc(e),n.gc().showAlert("DEL_SEL")})),n.Nb(11,"i",22),n.Rb(),n.Sb(12,"button",23),n.ec("click",(function(){return n.wc(e),n.gc().showAlert("DEL_ALL")})),n.Nb(13,"i",24),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Sb(14,"div",12),n.Sb(15,"app-data-viewer-as-table",13),n.ec("selectedRowEvent",(function(t){return n.wc(e),n.gc().onUserStageSelected(t)})),n.Rb(),n.Rb(),n.Rb()}if(2&e){const e=n.gc();n.zb(2),n.mc("objectPrefix","wot-orn-stages")("columnDefItems",e.orgStagesClms)("rowDataitems",e.orgStages.pageContent)("showExportBtn",!1)("showTitleBar",!0)("showSelectBtn",!0),n.zb(4),n.mc("disabled",null==e.orgStages||null==e.orgStages.pageContent||0===e.orgStages.pageContent.length),n.zb(2),n.mc("disabled",null==e.stagesToAdd||0===e.stagesToAdd.length),n.zb(2),n.mc("disabled",null==e.stagesForDelete||0===e.stagesForDelete.length),n.zb(2),n.mc("disabled",null==e.userStages||null==e.userStages.pageContent||0===e.userStages.pageContent.length),n.zb(3),n.mc("objectPrefix","wot-user-stages")("columnDefItems",e.userStagesClms)("rowDataitems",e.userStages.pageContent)("showExportBtn",!1)("showTitleBar",!0)("showSelectBtn",!0)}}let Dt=(()=>{class e{constructor(e,t,s,i){this.generator=e,this.alertService=t,this.crudService=s,this.mmSpinnerService=i,this.RED="#dc3545",this.WARNING="warning",this.SUCCESS="success",this.wots=[],this.orgSearchDisable=!0,this.userSearchDisable=!0,this.searchOrgStagesModel={},this.orgStageFormDefs=[],this.orgStages={},this.orgStagesView=[],this.orgStagesClms=[],this.searchUserStagesModel={},this.userStageFormDefs=[],this.userStages={},this.userStagesView=[],this.userStagesClms=[],this.stagesHiddenClms=["pId","pIsSelected","pUserAuthStageId","pPermitStage"],this.stagesForDelete=[],this.stagesToAdd=[],this.userPageModel=new ae.a,this.orgPageModel=new ae.a}set selectedUser(e){this.selectedUserId=null==e?void 0:e.userId,this.selectedUserName=(null==e?void 0:e.firstName)+" "+(null==e?void 0:e.lastName),this.stagesToAdd=[],this.stagesForDelete=[],this.wots=[],this.orgStages={},this.userStages={},this.searchOrgStagesModel={},this.searchUserStagesModel={},this.selectedUserId&&(this.loadAuths(),this.loadOrgStagesByFilter(this.orgPageModel),this.loadUserStagesByFilter(this.userPageModel))}ngOnInit(){this.orgStageFormDefs=this.generator.getWotSearchStageDefModel(),this.userStageFormDefs=this.generator.getWotSearchStageDefModel()}onStageSelected(e){null!=e&&(e.isSelected?this.stagesToAdd.push(e.id):this.stagesToAdd=this.stagesToAdd.filter(t=>t!==e.id))}onUserStageSelected(e){null!=e&&(e.isSelected?this.stagesForDelete.push(e.userAuthStageId):this.stagesForDelete=this.stagesForDelete.filter(t=>t!==e.userAuthStageId))}clearOrgStagesSearchFilters(){this.searchOrgStagesModel={},this.orgPageModel.currentPage=0,this.loadOrgStagesByFilter(this.orgPageModel)}loadOrgStagesByFilter(e){if(this.orgPageModel=e,null==this.orgId)return void this.alertService.error(J.a.NO_ORGANIZATION_ERROR,{});if(null==this.selectedUserId)return void this.alertService.error(J.a.NO_USER_ERROR,{});this.mmSpinnerService.showMainModalSpinner();const t=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},null!=this.searchOrgStagesModel.popEknm&&{popEknm:this.searchOrgStagesModel.popEknm}),null!=this.searchOrgStagesModel.wotId&&{wotId:this.searchOrgStagesModel.wotId}),null!=this.searchOrgStagesModel.address&&{address:this.searchOrgStagesModel.address}),null!=this.searchOrgStagesModel.terCode&&{terCode:this.searchOrgStagesModel.terCode}),null!=this.searchOrgStagesModel.distEknm&&{distEknm:this.searchOrgStagesModel.distEknm}),{offset:e.currentPageWithOffset,size:e.rowsPerPage});this.crudService.loadPageContentWithOffsetAndSize(Rt,`${Rt.notLinkedUrl}/${this.orgId}/${this.selectedUserId}`,t).subscribe(e=>{this.orgStages=e,this.populateOrgView(),this.orgStages.pageContent=this.orgStagesView,this.addDataToTable("O"),this.mmSpinnerService.hideMainModalSpinner()},e=>{this.mmSpinnerService.hideMainModalSpinner()})}orgRowsChange(e){this.orgPageModel.rowsPerPage=e,this.orgPageModel.currentPage=0,this.loadOrgStagesByFilter(this.orgPageModel)}clearUserStagesSearchFilters(){this.searchUserStagesModel={},this.userPageModel.currentPage=0,this.loadUserStagesByFilter(this.userPageModel)}loadUserStagesByFilter(e){if(this.userPageModel=e,null==this.orgId)return void this.alertService.error(J.a.NO_ORGANIZATION_ERROR,{});if(null==this.selectedUserId)return void this.alertService.error(J.a.NO_USER_ERROR,{});this.mmSpinnerService.showMainModalSpinner();const t=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},null!=this.searchUserStagesModel.popEknm&&{popEknm:this.searchUserStagesModel.popEknm}),null!=this.searchUserStagesModel.wotId&&{wotId:this.searchUserStagesModel.wotId}),null!=this.searchUserStagesModel.address&&{address:this.searchUserStagesModel.address}),null!=this.searchOrgStagesModel.terCode&&{terCode:this.searchOrgStagesModel.terCode}),null!=this.searchOrgStagesModel.distEknm&&{distEknm:this.searchOrgStagesModel.distEknm}),{offset:e.currentPageWithOffset,size:e.rowsPerPage});this.crudService.loadPageContentWithOffsetAndSize(Rt,`${Rt.linkedUrl}/${this.orgId}/${this.selectedUserId}`,t).subscribe(e=>{this.userStages=e,this.populateUsrView(),this.userStages.pageContent=this.userStagesView,this.addDataToTable("U"),this.mmSpinnerService.hideMainModalSpinner()},e=>{this.mmSpinnerService.hideMainModalSpinner()})}userRowsChange(e){this.userPageModel.rowsPerPage=e,this.userPageModel.currentPage=0,this.loadUserStagesByFilter(this.userPageModel)}showAlert(e){const t=this.getTitle(e),s=this.getText(e),i=this.getFooter(e);le.a.fire({title:t,text:s,icon:this.WARNING,footer:i,showConfirmButton:!0,confirmButtonText:J.a.CONFIRM_BUTTON_TEXT,showCancelButton:!0,cancelButtonText:J.a.CANCEL_BUTTON_TEXT,cancelButtonColor:this.RED,allowOutsideClick:!1}).then(t=>{t.isConfirmed&&this.doWork(e)})}getTitle(e){let t="";switch(e){case"ADD_ALL":case"ADD_SEL":t=J.a.TITLE_USER_STAGE_ADD;break;case"DEL_ALL":case"DEL_SEL":t=J.a.TITLE_USER_STAGE_DELETE}return t}getText(e){let t="";switch(e){case"ADD_ALL":case"ADD_SEL":t=J.a.TEXT_USER_STAGE_ADD;break;case"DEL_ALL":case"DEL_SEL":t=J.a.TEXT_USER_STAGE_DELETE}return t}getFooter(e){const t=this.selectedUserName;let s=0;switch(e){case"ADD_ALL":s=this.orgStages.pageContent?this.orgStages.pageContent.length:0;break;case"ADD_SEL":s=this.stagesToAdd?this.stagesToAdd.length:0;break;case"DEL_ALL":s=this.userStages.pageContent?this.userStages.pageContent.length:0;break;case"DEL_SEL":s=this.stagesForDelete?this.stagesForDelete.length:0}return`\u041f\u043e\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043b: ${t}. \u0418\u0437\u0431\u0440\u0430\u043d\u0438 \u043f\u043b\u043e\u0449\u0430\u0434\u043a\u0438: ${s}.`}addDataToTable(e){switch(e){case"D":break;case"O":this.orgStagesClms=Object(re.a)(this.orgStages.pageContent,this.orgStagesClms,this.stagesHiddenClms);break;case"U":this.userStagesClms=Object(re.a)(this.userStages.pageContent,this.userStagesClms,this.stagesHiddenClms)}}loadAuths(){this.crudService.loadByParam(vt,vt.url,this.orgId).subscribe(e=>{this.wots=e})}addUserStageRel(){if(null==this.orgId)return void this.alertService.error(J.a.NO_ORGANIZATION_ERROR,{});if(null==this.selectedUserId)return void this.alertService.error(J.a.NO_USER_ERROR,{});if(null==this.stagesToAdd||0===this.stagesToAdd.length)return void this.alertService.error(J.a.NO_STAGE_ERROR,{});const e=this.stagesToAdd.map(e=>{const t=new mt.a(ne.a.getNowAsNgbDateStruct());return new ut({authStageId:e,userId:this.selectedUserId,orgId:this.orgId,dateFrom:t})});return this.crudService.createMany(ut.url,e).subscribe(e=>{this.stagesToAdd=[],this.loadOrgStagesByFilter(this.orgPageModel),this.loadUserStagesByFilter(this.userPageModel)})}deleteUserStageRel(){if(null!=this.stagesForDelete&&0!==this.stagesForDelete.length)return this.crudService.deleteMany(ut.url,this.stagesForDelete).subscribe(e=>{this.stagesForDelete=[],this.loadOrgStagesByFilter(this.orgPageModel),this.loadUserStagesByFilter(this.userPageModel)});this.alertService.error(J.a.NO_STAGE_ERROR,{})}changeSerchFormDefs(e,t){for(let s=1;s<e.length;s++)e[s].readonly=t,e[s].isDisabled=t}doWork(e){switch(e){case"ADD_ALL":this.onInsertAllStages();break;case"ADD_SEL":this.onInsertStages();break;case"DEL_ALL":this.onDeleteAllStages();break;case"DEL_SEL":this.onDeleteStages()}}onInsertAllStages(){this.stagesToAdd=[],this.stagesToAdd=this.orgStages.pageContent.map(e=>e.id),this.addUserStageRel()}onInsertStages(){this.addUserStageRel()}onDeleteStages(){this.deleteUserStageRel()}onDeleteAllStages(){this.stagesForDelete=[],this.stagesForDelete=this.userStages.pageContent.map(e=>e.userAuthStageId),this.deleteUserStageRel()}populateOrgView(){this.orgStagesView=[],this.orgStages.pageContent.forEach(e=>{const t=this.orgStagesView.find(t=>t.id===e.id);t?t.wotData=[...t.wotData,e.wotData]:this.orgStagesView.push(this.getViewFromModel(e))})}populateUsrView(){this.userStagesView=[],this.userStages.pageContent.forEach(e=>{const t=this.userStagesView.find(t=>t.userAuthStageId===e.userAuthStageId);t?t.wotData=[...t.wotData,e.wotData]:this.userStagesView.push(this.getViewFromModel(e))})}getViewFromModel(e){const t=new Mt;return t.id=e.id,t.terName=e.terName,t.distName=e.distName,t.popName=e.popName,t.address=e.address,t.permitStage=e.permitStage,t.userAuthStageId=e.userAuthStageId,t.isSelected=e.isSelected,t.wotData=[e.wotData],t}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(ge.a),n.Mb(Y.a),n.Mb(f.a),n.Mb(H.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-wot-user-stages"]],inputs:{orgId:"orgId",selectedUser:"selectedUser"},decls:41,vars:59,consts:[[1,"container-fluid"],[1,"row"],[1,"col-lg-6"],[1,"col-lg-12"],[3,"ngModel","formItemDef","labelFieldName","valueFieldName","name","externalDataItems","ngModelChange"],[1,"col-lg-4"],[3,"ngModel","formItemDef","labelFieldName","valueFieldName","name","ngModelChange"],[3,"ngModel","formItemDef","name","ngModelChange"],[1,"mt-1"],[3,"isFormValid","currentPage","isPagingDisabled","totalRows","showTotalRows","clearEvent","searchEvent","pageChangeEvent","rowPerPageChangeEvent"],["class","row mt-2",4,"ngIf"],[1,"row","mt-2"],[1,"col-lg-5"],[3,"objectPrefix","columnDefItems","rowDataitems","showExportBtn","showTitleBar","showSelectBtn","selectedRowEvent"],[1,"col-lg-2"],[1,"d-flex","justify-content-center","align-items-end","h-100"],["role","group",1,"btn-group-vertical"],["type","button","placement","left","ngbTooltip","\u0410\u0446\u043e\u0446\u0438\u0438\u0440\u0430\u043d\u0435 \u043d\u0430 \u0432\u0441\u0438\u0447\u043a\u0438 \u043f\u043b\u043e\u0449\u0430\u0434\u043a\u0438","container","body",1,"btn","btn-outline-secondary","mb-1",3,"disabled","click"],[1,"fas","fa-angle-double-right"],["type","button","ngbTooltip","\u0410\u0446\u043e\u0446\u0438\u0438\u0440\u0430\u043d\u0435 \u043d\u0430 \u0438\u0437\u0431\u0440\u0430\u043d\u0438\u0442\u0435 \u043f\u043b\u043e\u0449\u0430\u0434\u043a\u0438","container","body",1,"btn","btn-outline-secondary","mb-1",3,"disabled","click"],[1,"fas","fa-angle-right"],["type","button","ngbTooltip","\u041f\u0440\u0435\u043a\u0440\u0430\u0442\u044f\u0432\u0430\u043d\u0435 \u043d\u0430 \u0434\u043e\u0441\u0442\u044a\u043f\u0430 \u0434\u043e \u0438\u0437\u0431\u0440\u0430\u043d\u0438\u0442\u0435 \u043f\u043b\u043e\u0449\u0430\u0434\u043a\u0438","container","body",1,"btn","btn-outline-secondary","mb-1",3,"disabled","click"],[1,"fas","fa-angle-left"],["type","button","ngbTooltip","\u041f\u0440\u0435\u043a\u0440\u0430\u0442\u044f\u0432\u0430\u043d\u0435 \u043d\u0430 \u0434\u043e\u0441\u0442\u044a\u043f\u0430 \u0434\u043e \u0432\u0441\u0438\u0447\u043a\u0438 \u043f\u043b\u043e\u0449\u0430\u0434\u043a\u0438","container","body",1,"btn","btn-outline-secondary","mb-1",3,"disabled","click"],[1,"fas","fa-angle-double-left"]],template:function(e,t){1&e&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Sb(2,"div",2),n.Sb(3,"h5"),n.Gc(4,"\u0412\u0441\u0438\u0447\u043a\u0438 \u043f\u043b\u043e\u0449\u0430\u0434\u043a\u0438"),n.Rb(),n.Nb(5,"hr"),n.Sb(6,"div",1),n.Sb(7,"div",3),n.Sb(8,"app-fi-select-dropdown",4),n.ec("ngModelChange",(function(e){return t.searchOrgStagesModel.wotId=e})),n.Rb(),n.Rb(),n.Rb(),n.Sb(9,"div",1),n.Sb(10,"div",5),n.Sb(11,"app-fi-select-dropdown-cascade",6),n.ec("ngModelChange",(function(e){return t.searchOrgStagesModel.terCode=e})),n.Rb(),n.Rb(),n.Sb(12,"div",5),n.Sb(13,"app-fi-select-dropdown-cascade",6),n.ec("ngModelChange",(function(e){return t.searchOrgStagesModel.distEknm=e})),n.Rb(),n.Rb(),n.Sb(14,"div",5),n.Sb(15,"app-fi-select-dropdown-cascade",6),n.ec("ngModelChange",(function(e){return t.searchOrgStagesModel.popEknm=e})),n.Rb(),n.Rb(),n.Rb(),n.Sb(16,"div",1),n.Sb(17,"div",3),n.Sb(18,"app-fi-input-text",7),n.ec("ngModelChange",(function(e){return t.searchOrgStagesModel.address=e})),n.Rb(),n.Rb(),n.Rb(),n.Nb(19,"div",8),n.Sb(20,"app-search-and-navigation-bar",9),n.ec("clearEvent",(function(){return t.clearOrgStagesSearchFilters()}))("searchEvent",(function(e){return t.loadOrgStagesByFilter(e)}))("pageChangeEvent",(function(e){return t.loadOrgStagesByFilter(e)}))("rowPerPageChangeEvent",(function(e){return t.orgRowsChange(e)})),n.Rb(),n.Rb(),n.Sb(21,"div",2),n.Sb(22,"h5"),n.Gc(23,"\u0410\u0441\u043e\u0446\u0438\u0438\u0440\u0430\u043d\u0438 \u043f\u043b\u043e\u0449\u0430\u0434\u043a\u0438"),n.Rb(),n.Nb(24,"hr"),n.Sb(25,"div",1),n.Sb(26,"div",3),n.Sb(27,"app-fi-select-dropdown",4),n.ec("ngModelChange",(function(e){return t.searchUserStagesModel.wotId=e})),n.Rb(),n.Rb(),n.Rb(),n.Sb(28,"div",1),n.Sb(29,"div",5),n.Sb(30,"app-fi-select-dropdown-cascade",6),n.ec("ngModelChange",(function(e){return t.searchUserStagesModel.terCode=e})),n.Rb(),n.Rb(),n.Sb(31,"div",5),n.Sb(32,"app-fi-select-dropdown-cascade",6),n.ec("ngModelChange",(function(e){return t.searchUserStagesModel.distEknm=e})),n.Rb(),n.Rb(),n.Sb(33,"div",5),n.Sb(34,"app-fi-select-dropdown-cascade",6),n.ec("ngModelChange",(function(e){return t.searchUserStagesModel.popEknm=e})),n.Rb(),n.Rb(),n.Rb(),n.Sb(35,"div",1),n.Sb(36,"div",3),n.Sb(37,"app-fi-input-text",7),n.ec("ngModelChange",(function(e){return t.searchUserStagesModel.address=e})),n.Rb(),n.Rb(),n.Rb(),n.Nb(38,"div",8),n.Sb(39,"app-search-and-navigation-bar",9),n.ec("clearEvent",(function(){return t.clearUserStagesSearchFilters()}))("searchEvent",(function(e){return t.loadUserStagesByFilter(e)}))("pageChangeEvent",(function(e){return t.loadUserStagesByFilter(e)}))("rowPerPageChangeEvent",(function(e){return t.userRowsChange(e)})),n.Rb(),n.Rb(),n.Rb(),n.Ec(40,It,16,16,"div",10),n.Rb()),2&e&&(n.zb(8),n.mc("ngModel",t.searchOrgStagesModel.wotId)("formItemDef",t.orgStageFormDefs[0])("labelFieldName","ewc")("valueFieldName","id")("name",t.orgStageFormDefs[0].domName)("externalDataItems",t.wots),n.zb(3),n.mc("ngModel",t.searchOrgStagesModel.terCode)("formItemDef",t.orgStageFormDefs[1])("labelFieldName","terName")("valueFieldName","terCode")("name",t.orgStageFormDefs[1].domName),n.zb(2),n.mc("ngModel",t.searchOrgStagesModel.distEknm)("formItemDef",t.orgStageFormDefs[2])("labelFieldName","distName")("valueFieldName","distEknm")("name",t.orgStageFormDefs[2].domName),n.zb(2),n.mc("ngModel",t.searchOrgStagesModel.popEknm)("formItemDef",t.orgStageFormDefs[3])("labelFieldName","popName")("valueFieldName","popEknm")("name",t.orgStageFormDefs[3].domName),n.zb(3),n.mc("ngModel",t.searchOrgStagesModel.address)("formItemDef",t.orgStageFormDefs[4])("name",t.orgStageFormDefs[4].domName),n.zb(2),n.mc("isFormValid",!0)("currentPage",t.orgStages.pageWithOutOffset)("isPagingDisabled",!1)("totalRows",t.orgStages.totalRows)("showTotalRows",!1),n.zb(7),n.mc("ngModel",t.searchUserStagesModel.wotId)("formItemDef",t.userStageFormDefs[0])("labelFieldName","ewc")("valueFieldName","id")("name",t.userStageFormDefs[0].domName)("externalDataItems",t.wots),n.zb(3),n.mc("ngModel",t.searchUserStagesModel.terCode)("formItemDef",t.userStageFormDefs[1])("labelFieldName","terName")("valueFieldName","terCode")("name",t.userStageFormDefs[1].domName),n.zb(2),n.mc("ngModel",t.searchUserStagesModel.distEknm)("formItemDef",t.userStageFormDefs[2])("labelFieldName","distName")("valueFieldName","distEknm")("name",t.userStageFormDefs[2].domName),n.zb(2),n.mc("ngModel",t.searchUserStagesModel.popEknm)("formItemDef",t.userStageFormDefs[3])("labelFieldName","popName")("valueFieldName","popEknm")("name",t.userStageFormDefs[3].domName),n.zb(3),n.mc("ngModel",t.searchUserStagesModel.address)("formItemDef",t.userStageFormDefs[4])("name",t.userStageFormDefs[4].domName),n.zb(2),n.mc("isFormValid",!0)("currentPage",t.userStages.page)("isPagingDisabled",!1)("totalRows",t.userStages.totalRows)("showTotalRows",!1),n.zb(1),n.mc("ngIf",t.orgStages.pageContent&&t.orgStages.pageContent.length||t.userStages.pageContent&&t.userStages.pageContent.length))},directives:[Ue.a,he.o,he.r,pt.a,Ce.a,me.a,i.u,pe.a,c.ab],styles:[""]}),e})();function Et(e,t){if(1&e&&(n.Sb(0,"div",8),n.Sb(1,"h6",9),n.Gc(2," \u0422\u042a\u0420\u0421\u0415\u041d\u0415 \u041d\u0410 \u041f\u041e\u0422\u0420\u0415\u0411\u0418\u0422\u0415\u041b \u0412 \u0415\u041a\u0418\u041f\u0410 "),n.Rb(),n.Sb(3,"div"),n.Sb(4,"button",10),n.Nb(5,"i",11),n.Nb(6,"i",12),n.Rb(),n.Rb(),n.Rb()),2&e){n.gc();const e=n.vc(8);n.zb(5),n.mc("hidden",e.isExpanded("search")),n.zb(1),n.mc("hidden",!e.isExpanded("search"))}}function Ot(e,t){if(1&e){const e=n.Tb();n.Sb(0,"div",13),n.Sb(1,"div",14),n.Sb(2,"app-fi-input-text",15),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc().searchModel.firstName=t})),n.Rb(),n.Rb(),n.Sb(3,"div",14),n.Sb(4,"app-fi-input-text",15),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc().searchModel.midName=t})),n.Rb(),n.Rb(),n.Sb(5,"div",14),n.Sb(6,"app-fi-input-text",15),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc().searchModel.lastName=t})),n.Rb(),n.Rb(),n.Rb(),n.Sb(7,"div",13),n.Sb(8,"div",14),n.Sb(9,"app-fi-select-dropdown",16),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc().searchModel.role=t})),n.Rb(),n.Rb(),n.Rb(),n.Nb(10,"div",17),n.Sb(11,"app-search-and-navigation-bar",18),n.ec("clearEvent",(function(){return n.wc(e),n.gc().clearSearchFilters()}))("searchEvent",(function(t){return n.wc(e),n.gc().loadDataByFilter(t)}))("pageChangeEvent",(function(t){return n.wc(e),n.gc().loadDataByFilter(t)}))("rowPerPageChangeEvent",(function(t){return n.wc(e),n.gc().rowsPerPageChange(t)})),n.Rb(),n.Nb(12,"div",17),n.Sb(13,"app-data-viewer-as-table",19),n.ec("selectedRowEvent",(function(t){return n.wc(e),n.gc().onUserSelected(t)})),n.Rb()}if(2&e){const e=n.gc();n.zb(2),n.mc("ngModel",e.searchModel.firstName)("formItemDef",e.formDefs[0])("name",e.formDefs[0].domName),n.zb(2),n.mc("ngModel",e.searchModel.midName)("formItemDef",e.formDefs[1])("name",e.formDefs[1].domName),n.zb(2),n.mc("ngModel",e.searchModel.lastName)("formItemDef",e.formDefs[2])("name",e.formDefs[2].domName),n.zb(3),n.mc("ngModel",e.searchModel.role)("formItemDef",e.formDefs[3])("labelFieldName","description")("valueFieldName","id")("name",e.formDefs[3].domName),n.zb(2),n.mc("isFormValid",!0)("currentPage",e.data.pageWithOutOffset)("isPagingDisabled",!1)("totalRows",e.data.totalRows),n.zb(2),n.mc("columnDefItems",e.clms)("rowDataitems",e.data.pageContent)("showExportBtn",!1)("showTitleBar",!1)("showSelectBtn",!0)}}function wt(e,t){if(1&e&&(n.Sb(0,"div",8),n.Sb(1,"h6",9),n.Gc(2," \u041f\u041b\u041e\u0429\u0410\u0414\u041a\u0418 "),n.Rb(),n.Sb(3,"div"),n.Sb(4,"button",10),n.Nb(5,"i",11),n.Nb(6,"i",12),n.Rb(),n.Rb(),n.Rb()),2&e){n.gc();const e=n.vc(8);n.zb(5),n.mc("hidden",e.isExpanded("stages")),n.zb(1),n.mc("hidden",!e.isExpanded("stages"))}}function Nt(e,t){if(1&e&&n.Nb(0,"app-aun-user-stages",26),2&e){const e=n.gc(2);n.mc("orgId",e.orgId)("selectedUser",e.selectedUser)}}function Ct(e,t){if(1&e&&n.Nb(0,"app-wot-user-stages",26),2&e){const e=n.gc(2);n.mc("orgId",e.orgId)("selectedUser",e.selectedUser)}}function yt(e,t){if(1&e&&(n.Sb(0,"ul",20,21),n.Sb(2,"li",22),n.Sb(3,"a",23),n.Gc(4,"\u0417\u0430\u044f\u0432\u043b\u0435\u043d\u0438\u044f"),n.Rb(),n.Ec(5,Nt,1,2,"ng-template",24),n.Rb(),n.Sb(6,"li",22),n.Sb(7,"a",23),n.Gc(8,"\u0420\u0430\u0431\u043e\u0442\u043d\u0438 \u043b\u0438\u0441\u0442\u0430"),n.Rb(),n.Ec(9,Ct,1,2,"ng-template",24),n.Rb(),n.Rb(),n.Nb(10,"div",25)),2&e){const e=n.vc(1);n.mc("activeId",1)("destroyOnHide",!1),n.zb(2),n.mc("ngbNavItem",1),n.zb(4),n.mc("ngbNavItem",2),n.zb(4),n.mc("ngbNavOutlet",e)}}const Tt=function(){return["search","stages"]};let At=(()=>{class e{constructor(e,t,s,i,a){this.generator=e,this.mmSpinnerService=t,this.crudService=s,this.sessionService=i,this.alertService=a,this.searchModel={},this.formDefs=[],this.data={},this.clms=[],this.hiddenClms=["pId","pIsSelected","pDateCreated","pEmail","pStatusDescription","pRoleId","pStatusCode","pUserId","pIsSigned","pIsSignedLabel"],this.currentPageModel=new ae.a}ngOnInit(){this.formDefs=this.generator.getMngStagesDefModel(),this.getOrgId(),this.loadDataByFilter(this.currentPageModel)}onUserSelected(e){this.selectedUser=e.isSelected?e:null}clearSearchFilters(){this.searchModel={},this.currentPageModel.currentPage=0,this.loadDataByFilter(this.currentPageModel)}loadDataByFilter(e){if(this.currentPageModel=e,null==this.orgId)return void this.alertService.error(J.a.NO_ORGANIZATION_ERROR,{});this.mmSpinnerService.showMainModalSpinner();const t=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},null!=this.searchModel.firstName&&{firstName:this.searchModel.firstName}),null!=this.searchModel.midName&&{midName:this.searchModel.midName}),null!=this.searchModel.lastName&&{lastName:this.searchModel.lastName}),null!=this.searchModel.role&&{roeId:this.searchModel.role}),{offset:e.currentPageWithOffset,size:e.rowsPerPage});this.crudService.loadPageContentWithOffsetAndSize(st.a,`${st.a.stageUrl}/${this.orgId}`,t).subscribe(e=>{this.selectedUser=null,this.data=e,this.addDataToTable(),this.mmSpinnerService.hideMainModalSpinner()},e=>{this.mmSpinnerService.hideMainModalSpinner()})}rowsPerPageChange(e){this.currentPageModel.rowsPerPage=e,this.currentPageModel.currentPage=0,this.loadDataByFilter(this.currentPageModel)}addDataToTable(){this.clms=Object(re.a)(this.data.pageContent,this.clms,this.hiddenClms)}getOrgId(){const e=this.sessionService.getOrganization();this.orgId=e?e.id:null}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(ge.a),n.Mb(H.a),n.Mb(f.a),n.Mb(v.a),n.Mb(Y.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-user-stages"]],decls:15,vars:3,consts:[[1,"container-fluid","p-3"],[1,"text-center","mb-4"],["id","accordion",3,"destroyOnHide","activeIds"],["acc","ngbAccordion"],["id","search"],["ngbPanelHeader",""],["id","body","ngbPanelContent",""],["id","stages"],[1,"d-flex","align-items-center","justify-content-between"],[1,"m-0"],["ngbPanelToggle","",1,"btn","btn-sm","btn-outline-secondary","rounded-circle"],[1,"fas","fa-chevron-right",3,"hidden"],[1,"fas","fa-chevron-down",3,"hidden"],[1,"row"],[1,"col-lg-4"],[3,"ngModel","formItemDef","name","ngModelChange"],[3,"ngModel","formItemDef","labelFieldName","valueFieldName","name","ngModelChange"],[1,"mt-1"],[3,"isFormValid","currentPage","isPagingDisabled","totalRows","clearEvent","searchEvent","pageChangeEvent","rowPerPageChangeEvent"],[3,"columnDefItems","rowDataitems","showExportBtn","showTitleBar","showSelectBtn","selectedRowEvent"],["ngbNav","",1,"nav-tabs",3,"activeId","destroyOnHide"],["nav","ngbNav"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-2",3,"ngbNavOutlet"],[3,"orgId","selectedUser"]],template:function(e,t){1&e&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Sb(2,"div"),n.Sb(3,"h4"),n.Gc(4,"\u0410\u0421\u041e\u0426\u0418\u0418\u0420\u0410\u041d\u0415 \u041d\u0410 \u0420\u0410\u0411\u041e\u0422\u041d\u0418 \u041f\u041b\u041e\u0429\u0410\u0414\u041a\u0418"),n.Rb(),n.Sb(5,"h6"),n.Gc(6,"\u0421 \u0420\u0415\u0413\u0418\u0421\u0422\u0420\u0418\u0420\u0410\u041d\u0418\u0422\u0415 \u0412 \u0415\u041a\u0418\u041f\u0410 \u041f\u041e\u0422\u0420\u0415\u0411\u0418\u0422\u0415\u041b\u0418"),n.Rb(),n.Rb(),n.Rb(),n.Sb(7,"ngb-accordion",2,3),n.Sb(9,"ngb-panel",4),n.Ec(10,Et,7,2,"ng-template",5),n.Ec(11,Ot,14,23,"ng-template",6),n.Rb(),n.Sb(12,"ngb-panel",7),n.Ec(13,wt,7,2,"ng-template",5),n.Ec(14,yt,11,5,"ng-template",6),n.Rb(),n.Rb(),n.Rb()),2&e&&(n.zb(7),n.mc("destroyOnHide",!1)("activeIds",n.pc(2,Tt)))},directives:[c.a,c.I,c.K,c.J,c.M,Ce.a,he.o,he.r,Ue.a,me.a,pe.a,c.v,c.x,c.y,c.w,c.z,ft,Dt],styles:["[_nghost-%COMP%]     #accordion>div>div.card-header, [_nghost-%COMP%]     #accordion>div>div>div.card-body{padding:.5rem}"]}),e})();var Pt=s("lJxs");let Ft=(()=>{class e{constructor(e,t){this.oidcSecurityService=e,this.router=t}canActivate(e,t){return this.oidcSecurityService.checkAuth().pipe(Object(Pt.a)(e=>!!e||(this.router.navigate(["/home"]),!1)))}}return e.\u0275fac=function(t){return new(t||e)(n.ac(S.d),n.ac(a.c))},e.\u0275prov=n.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Ut=s("qW6x");function zt(e,t){1&e&&(n.Sb(0,"div",8),n.Sb(1,"div",9),n.Sb(2,"div",10),n.Sb(3,"div",11),n.Nb(4,"i",12),n.Rb(),n.Rb(),n.Sb(5,"div",13),n.Sb(6,"div",3),n.Sb(7,"p",14),n.Gc(8," \u041c\u043e\u043b\u044f \u0438\u0437\u0447\u0430\u043a\u0430\u0439\u0442\u0435 \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u0430\u043d\u0435\u0442\u043e \u043d\u0430 \u043f\u043e\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043b\u0441\u043a\u0438 \u043f\u0440\u043e\u0444\u0438\u043b! "),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Rb())}function _t(e,t){if(1&e){const e=n.Tb();n.Sb(0,"div",15),n.Sb(1,"div",9),n.Sb(2,"div",10),n.Sb(3,"div",11),n.Nb(4,"i",16),n.Rb(),n.Rb(),n.Sb(5,"div",13),n.Sb(6,"div",3),n.Sb(7,"p",14),n.Gc(8," \u0410\u043a\u0442\u0438\u0432\u0438\u0440\u0430\u043d\u0435\u0442\u043e \u043d\u0430 \u043f\u043e\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043b\u0441\u043a\u0438 \u043f\u0440\u043e\u0444\u0438\u043b \u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e! "),n.Rb(),n.Sb(9,"p",17),n.Gc(10," \u0417\u0430 \u0434\u0430 \u0432\u043b\u0435\u0437\u0435\u0442\u0435 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0430\u0442\u0430, \u043d\u0430\u0442\u0438\u0441\u043d\u0435\u0442\u0435 "),n.Sb(11,"a",18),n.ec("click",(function(t){return n.wc(e),n.gc().goToLogin(),t.preventDefault()})),n.Gc(12,"\u0442\u0443\u043a"),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Rb()}}function kt(e,t){if(1&e&&(n.Sb(0,"div",19),n.Sb(1,"div",9),n.Sb(2,"div",10),n.Sb(3,"div",11),n.Nb(4,"i",20),n.Rb(),n.Rb(),n.Sb(5,"div",13),n.Sb(6,"div",3),n.Sb(7,"p",21),n.Sb(8,"b"),n.Gc(9,"\u0412\u044a\u0437\u043d\u0438\u043a\u043d\u0430 \u0433\u0440\u0435\u0448\u043a\u0430!"),n.Rb(),n.Rb(),n.Sb(10,"p",17),n.Gc(11),n.Rb(),n.Sb(12,"p",17),n.Gc(13," \u0417\u0430 \u0434\u0430 \u043e\u0442\u0438\u0434\u0435\u0442\u0435 \u043d\u0430 \u043d\u0430\u0447\u0430\u043b\u043d\u0430\u0442\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0430 \u041d\u0418\u0421\u041e, \u043d\u0430\u0442\u0438\u0441\u043d\u0435\u0442\u0435 "),n.Sb(14,"a",22),n.Gc(15,"\u0442\u0443\u043a"),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Rb()),2&e){const e=n.gc();n.zb(11),n.Ic(" ",e.error," ")}}let Bt=(()=>{class e{constructor(e,t,s){this.oidcSecurityService=e,this.route=t,this.authService=s,this.loading=!0,this.success=!1,this.error=null,this.token=null}ngOnInit(){this.getToken()}goToLogin(){this.oidcSecurityService.authorize()}getToken(){this.route.params.subscribe(e=>{this.token=e.token,this.activateProfile()})}activateProfile(){null!=this.token&&this.authService.activation("TrnUsers/activation",this.token).subscribe(e=>{this.loading=!1,this.success=!0},e=>{var t;this.error=(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message)||"\u0413\u0440\u0435\u0448\u043a\u0430 \u043f\u0440\u0438 \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u0430\u043d\u0435 \u043d\u0430 \u043f\u043e\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043b\u0441\u043a\u0438 \u043f\u0440\u043e\u0444\u0438\u043b",this.loading=!1})}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(S.d),n.Mb(a.a),n.Mb(Ut.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-activate-profile-page"]],decls:10,vars:3,consts:[[1,"container","p-3"],[1,"card"],[1,"card-header"],[1,"card-body"],["class","card border-secondary mb-2",4,"ngIf"],["class","card border-success mb-2",4,"ngIf"],["class","card border-danger",4,"ngIf"],[1,"card-footer"],[1,"card","border-secondary","mb-2"],[1,"row","no-gutters"],[1,"col-md-2"],[1,"d-flex","justify-content-center","align-items-center","h-100"],[1,"fas","fa-spinner","fa-spin","fa-2x"],[1,"col-md-10"],[1,"card-text","font-weight-bold"],[1,"card","border-success","mb-2"],[1,"fas","fa-check-double","text-success","fa-3x"],[1,"font-italic"],["href","",1,"text-success","font-weight-bold",3,"click"],[1,"card","border-danger"],[1,"fas","fa-exclamation","text-danger","fa-3x"],[1,"card-text"],["routerLink","/home",1,"text-primary","font-weight-bold"]],template:function(e,t){1&e&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Sb(2,"div",2),n.Sb(3,"h5"),n.Gc(4,"\u0410\u043a\u0442\u0438\u0432\u0438\u0440\u0430\u043d\u0435 \u043d\u0430 \u043f\u0440\u043e\u0444\u0438\u043b"),n.Rb(),n.Rb(),n.Sb(5,"div",3),n.Ec(6,zt,9,0,"div",4),n.Ec(7,_t,13,0,"div",5),n.Ec(8,kt,16,1,"div",6),n.Rb(),n.Nb(9,"div",7),n.Rb(),n.Rb()),2&e&&(n.zb(6),n.mc("ngIf",t.loading),n.zb(1),n.mc("ngIf",!t.loading&&!t.error&&t.success),n.zb(1),n.mc("ngIf",t.error))},directives:[i.u,a.f],styles:[""]}),e})(),Lt=(()=>{class e{constructor(e){e&&(this.password=e.password,this.confirmPassword=e.confirmPassword)}get password(){return this.pPassword}set password(e){this.pPassword=e}get confirmPassword(){return this.pConfirmPassword}set confirmPassword(e){this.pConfirmPassword=e}}return e.url="TrnUsers/forgottenPassword",Object(m.b)([Object(oe.b)({alias:"password"})],e.prototype,"pPassword",void 0),e})();var xt=s("122/"),jt=s("rC+L"),Gt=s("RP2b");function Vt(e,t){if(1&e){const e=n.Tb();n.Sb(0,"div",14),n.Sb(1,"div",15),n.Sb(2,"small",16),n.Sb(3,"b"),n.Gc(4),n.hc(5,"translate"),n.Rb(),n.Rb(),n.Sb(6,"button",17),n.ec("click",(function(){return n.wc(e),n.gc().removeAlert()})),n.Sb(7,"span",18),n.Gc(8,"\xd7"),n.Rb(),n.Rb(),n.Rb(),n.Sb(9,"small"),n.Gc(10),n.Rb(),n.Rb()}if(2&e){const e=n.gc();n.mc("ngClass",e.error?"alert-danger":"alert-success"),n.zb(4),n.Hc(n.ic(5,3,e.error?"messages.alerts.error":"messages.alerts.success")),n.zb(6),n.Ic(" ",e.error?e.error:e.success," ")}}let Ht=(()=>{class e{constructor(e,t,s){this.generator=e,this.crudService=t,this.route=s,this.model=new Lt,this.formDefs=[],this.error=null,this.success=null,this.formDisabled=!1,this.token=null}ngOnInit(){this.formDefs=this.generator.getResetPassPageModel(),this.getToken()}onSave(){this.removeAlert(),this.formDisabled=!0,this.crudService.saveData(Lt.url,this.model,this.token).subscribe(e=>{this.success=J.a.SUCCESS_MSG},e=>{var t;this.formDisabled=!1;const s=null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.systemMessage;this.error=s||J.a.ERROR_RESEST_PASS})}removeAlert(){this.error=null,this.success=null}getToken(){this.route.params.subscribe(e=>{this.token=e.token})}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(xt.a),n.Mb(f.a),n.Mb(a.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-reset-password-page"]],decls:23,vars:25,consts:[[1,"container","p-3"],[1,"card"],[1,"card-header"],[1,"card-body"],[3,"disabled"],["novalidate","",1,"was-validated"],["form","ngForm"],[3,"ngModel","formItemDef","name","ngModelChange"],[3,"ngModel","formItemDef","name","password","ngModelChange"],["class","alert alert-dismissable mx-0 my-2",3,"ngClass",4,"ngIf"],[1,"card-footer"],[1,"d-flex","justify-content-end"],["routerLink","/home","role","button",1,"btn","btn-outline-secondary","mr-2",3,"ngbTooltip"],["type","button",1,"btn","btn-outline-secondary",3,"ngbTooltip","disabled","click"],[1,"alert","alert-dismissable","mx-0","my-2",3,"ngClass"],[1,"d-flex","w-100","justify-content-between"],[1,"mb-1"],["type","button",1,"close",3,"click"],["aria-hidden","true"]],template:function(e,t){if(1&e&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Sb(2,"div",2),n.Sb(3,"h5"),n.Gc(4),n.hc(5,"translate"),n.Rb(),n.Rb(),n.Sb(6,"div",3),n.Sb(7,"fieldset",4),n.Sb(8,"form",5,6),n.Sb(10,"app-fi-input-password",7),n.ec("ngModelChange",(function(e){return t.model.password=e})),n.Rb(),n.Sb(11,"app-fi-input-confirm-pass",8),n.ec("ngModelChange",(function(e){return t.model.confirmPassword=e})),n.Rb(),n.Rb(),n.Rb(),n.Ec(12,Vt,11,5,"div",9),n.Rb(),n.Sb(13,"div",10),n.Sb(14,"div",11),n.Sb(15,"a",12),n.hc(16,"translate"),n.Gc(17),n.hc(18,"translate"),n.Rb(),n.Sb(19,"button",13),n.ec("click",(function(){return t.onSave()})),n.hc(20,"translate"),n.Gc(21),n.hc(22,"translate"),n.Rb(),n.Rb(),n.Rb(),n.Rb(),n.Rb()),2&e){const e=n.vc(9);n.zb(4),n.Hc(n.ic(5,15,"profile.resetPassword.title")),n.zb(3),n.mc("disabled",t.formDisabled),n.zb(3),n.mc("ngModel",t.model.password)("formItemDef",t.formDefs[0])("name",t.formDefs[0].domName),n.zb(1),n.mc("ngModel",t.model.confirmPassword)("formItemDef",t.formDefs[1])("name",t.formDefs[1].domName)("password",t.model.password),n.zb(1),n.mc("ngIf",t.error||t.success),n.zb(3),n.nc("ngbTooltip",n.ic(16,17,t.success?"buttons.back.label":"buttons.cancel.label")),n.zb(2),n.Hc(n.ic(18,19,t.success?"buttons.back.label":"buttons.cancel.label")),n.zb(2),n.nc("ngbTooltip",n.ic(20,21,"buttons.send.tooltip")),n.mc("disabled",!e.valid||t.formDisabled),n.zb(2),n.Ic(" ",n.ic(22,23,"buttons.send.label")," ")}},directives:[he.D,he.p,he.q,jt.a,he.o,he.r,Gt.a,i.u,a.f,c.ab,i.r],pipes:[l.d],styles:[""]}),e})();function Wt(e,t){if(1&e&&(n.Sb(0,"div",2),n.Nb(1,"app-sidebar-menu"),n.Rb()),2&e){const e=n.gc();n.mc("className",e.isVisibleSideMenu?"col-lg-2":"")}}let $t=(()=>{class e{constructor(){this.isVisibleSideMenu=!0}ngOnInit(){}onSideMenuBtnChanged(e){this.isVisibleSideMenu=!this.isVisibleSideMenu}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Gb({type:e,selectors:[["app-team-data-page"]],decls:5,vars:3,consts:[[1,"row","no-gutters"],[3,"className",4,"ngIf"],[3,"className"],[3,"defaultMenuItemId","menuBtnChanged"]],template:function(e,t){1&e&&(n.Sb(0,"div",0),n.Ec(1,Wt,2,1,"div",1),n.Sb(2,"div",2),n.Sb(3,"app-subheader",3),n.ec("menuBtnChanged",(function(e){return t.onSideMenuBtnChanged(e)})),n.Rb(),n.Nb(4,"router-outlet"),n.Rb(),n.Rb()),2&e&&(n.zb(1),n.mc("ngIf",t.isVisibleSideMenu),n.zb(1),n.mc("className",t.isVisibleSideMenu?"col-lg-10":"col-lg-12"),n.zb(1),n.mc("defaultMenuItemId",9))},directives:[i.u,o.a,a.h,k.a],styles:[""]}),e})();var Kt=s("KQ7d"),Xt=s("mdCJ"),Zt=s("+QWa"),qt=s("4WaZ"),Jt=s("pLGQ"),Yt=s("u7yH");function Qt(e,t){if(1&e&&(n.Sb(0,"div",8),n.Sb(1,"h6",9),n.Gc(2),n.hc(3,"translate"),n.Rb(),n.Sb(4,"div"),n.Sb(5,"button",10),n.Nb(6,"i",11),n.Nb(7,"i",12),n.Rb(),n.Rb(),n.Rb()),2&e){n.gc();const e=n.vc(10);n.zb(2),n.Ic(" ",n.ic(3,3,"applications.debtors.search.header")," "),n.zb(4),n.mc("hidden",e.isExpanded("search")),n.zb(1),n.mc("hidden",!e.isExpanded("search"))}}function es(e,t){if(1&e){const e=n.Tb();n.Sb(0,"div",18),n.Sb(1,"app-fi-input-uin",24),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc(2).searchModel.uin=t}))("searchEmitter",(function(t){return n.wc(e),n.gc(2).onSearchIndividual(t)})),n.Rb(),n.Rb()}if(2&e){n.gc();const e=n.vc(1),t=n.gc();n.zb(1),n.mc("ngModel",t.searchModel.uin)("formItemDef",t.searchFormDefs[2])("name",t.searchFormDefs[2].domName)("isSearchable",!0)("searchDisabled",!e.valid)}}function ts(e,t){if(1&e){const e=n.Tb();n.Sb(0,"div",18),n.Sb(1,"app-fi-input-eik",25),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc(2).searchModel.eik=t}))("searchEmitter",(function(){return n.wc(e),n.gc(2).onSearchLegalEntity()})),n.Rb(),n.Rb()}if(2&e){n.gc();const e=n.vc(1),t=n.gc();n.zb(1),n.mc("ngModel",t.searchModel.eik)("formItemDef",t.searchFormDefs[3])("name",t.searchFormDefs[3].domName)("isSearchable",!0)("searchDisabled",!e.valid)("showValidationCheck",!0)}}function ss(e,t){if(1&e&&(n.Sb(0,"span"),n.Gc(1),n.Rb()),2&e){const e=n.gc(2);n.zb(1),n.Ic(" ",e.searchResultText," ")}}function is(e,t){if(1&e){const e=n.Tb();n.Sb(0,"form",13,14),n.Sb(2,"h6",15),n.Gc(3),n.hc(4,"translate"),n.Rb(),n.Sb(5,"fieldset",16),n.Sb(6,"div",17),n.Sb(7,"div",18),n.Sb(8,"app-fi-input-radio-group",19),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc().searchModel.searchTypeI=t}))("valueEmitter",(function(t){return n.wc(e),n.gc().onRadioChange(t)})),n.Rb(),n.Rb(),n.Ec(9,es,2,5,"div",20),n.Rb(),n.Sb(10,"div",17),n.Sb(11,"div",18),n.Sb(12,"app-fi-input-radio-group",19),n.ec("ngModelChange",(function(t){return n.wc(e),n.gc().searchModel.searchTypeE=t}))("valueEmitter",(function(t){return n.wc(e),n.gc().onRadioChange(t)})),n.Rb(),n.Rb(),n.Ec(13,ts,2,6,"div",20),n.Rb(),n.Sb(14,"div",21),n.Sb(15,"div"),n.Ec(16,ss,2,1,"span",22),n.Rb(),n.Sb(17,"button",23),n.ec("click",(function(){n.wc(e);const t=n.gc(),s=n.vc(10);return t.onNewBtnClicked(),s.collapse("search")})),n.Gc(18),n.hc(19,"translate"),n.Rb(),n.Rb(),n.Rb(),n.Rb()}if(2&e){const e=n.vc(1),t=n.gc();n.zb(3),n.Ic(" ",n.ic(4,19,"applications.debtors.search.debtorType")," "),n.zb(2),n.mc("disabled",t.searchFormDisabled),n.zb(3),n.mc("source",t.individualType)("ngModel",t.searchModel.searchTypeI)("formItemDef",t.searchFormDefs[0])("name",t.searchFormDefs[0].domName)("labelFieldName","description")("valueFieldName","code"),n.zb(1),n.mc("ngIf","I"===t.searchModel.selectedType),n.zb(3),n.mc("source",t.legalEntityType)("ngModel",t.searchModel.searchTypeE)("formItemDef",t.searchFormDefs[1])("name",t.searchFormDefs[1].domName)("labelFieldName","description")("valueFieldName","code"),n.zb(1),n.mc("ngIf","E"===t.searchModel.selectedType),n.zb(3),n.mc("ngIf",t.searchResultText),n.zb(1),n.mc("disabled",!e.valid||!t.searchModel.selectedType||t.searchResult),n.zb(1),n.Ic(" ",n.ic(19,21,"applications.debtors.search.btnLabel")," ")}}function as(e,t){if(1&e){const e=n.Tb();n.Sb(0,"app-individual-form",26),n.ec("cancel",(function(){n.wc(e);const t=n.gc(),s=n.vc(10);return t.onCancel(),s.expand("search")})),n.Rb()}if(2&e){const e=n.gc();n.mc("model",e.individualModel)}}function rs(e,t){if(1&e){const e=n.Tb();n.Sb(0,"app-legal-entity-form",26),n.ec("cancel",(function(){n.wc(e);const t=n.gc(),s=n.vc(10);return t.onCancel(),s.expand("search")})),n.Rb()}if(2&e){const e=n.gc();n.mc("model",e.legalEntityModel)}}const ns=function(){return["search","individual","legal-entity"]},os=[{path:"",component:_,children:[{path:"",redirectTo:"login",pathMatch:"full"},{path:"registration",component:u},{path:"login",component:P,canActivate:[Ft]},{path:"profile",component:L,children:[{path:x.a.USER_PROFILE,component:Z},{path:x.a.USER_ORGANIZATION_ACCESS,component:tt},{path:x.a.DEBTORS,component:(()=>{class e{constructor(e,t){this.defsGenerator=e,this.crudService=t,this.searchFormDefs=[],this.searchModel={},this.types=[],this.searchResult=!0,this.searchResultText=null,this.searchFormDisabled=!1,this.showForm=!1,this.individualModel={},this.legalEntityModel={}}ngOnInit(){this.loadTypes(),this.searchFormDefs=this.defsGenerator.getSearchDefs()}get individualType(){const e=this.types.find(e=>"I"===e.code);return null==e?[]:[e]}get legalEntityType(){const e=this.types.find(e=>"E"===e.code);return null==e?[]:[e]}onSearchIndividual(e){null!=this.searchModel.uin&&(this.searchModel.uinType="EGN"===e?"E":"L",this.searchResultText=null,this.crudService.loadByParamsInArray(Boolean,Ee.a.urlGetByEgnBulstat,`egn=${this.searchModel.uin}`).subscribe(e=>{this.searchResult=!!(e&&e.length>0)&&e[0].valueOf(),this.resultMsg()}))}onSearchLegalEntity(){null!=this.searchModel.eik&&(this.searchResultText=null,this.crudService.loadByParamsInArray(Boolean,Ee.a.urlGetByEgnBulstat,`bulstat=${this.searchModel.eik}`).subscribe(e=>{this.searchResult=!!(e&&e.length>0)&&e[0].valueOf(),this.resultMsg()}))}onRadioChange(e){this.searchModel.selectedType=e.code,this.searchResultText=null,this.showForm=!1,"I"===e.code&&null!=this.searchModel.searchTypeE&&(this.searchModel.searchTypeE.isSelected=!1,this.searchModel.eik=null,this.searchModel.leName=null),"E"===e.code&&null!=this.searchModel.searchTypeI&&(this.searchModel.searchTypeI.isSelected=!1,this.searchModel.uin=null,this.searchModel.uinType=null)}onNewBtnClicked(){this.searchFormDisabled=!0,this.showForm=!0,"I"===this.searchModel.selectedType?(this.individualModel.org=new Xt.a({egn:this.searchModel.uin,indOrEntity:this.searchModel.selectedType,validationType:this.searchModel.uinType}),this.individualModel.contacts=[new Kt.a],this.individualModel.headquarters=new Jt.a({type:qt.a.ORG_ADDRESS}),this.individualModel.address=new Jt.a({type:qt.a.MAILING_ADDRESS}),this.individualModel.docs=[{index:Object(Zt.a)()}]):(this.legalEntityModel.org=new Xt.a({bulstat:this.searchModel.eik,indOrEntity:this.searchModel.selectedType,validationType:"O"}),this.legalEntityModel.contacts=[new Kt.a],this.legalEntityModel.headquarters=new Jt.a({type:qt.a.ORG_ADDRESS}),this.legalEntityModel.address=new Jt.a({type:qt.a.MAILING_ADDRESS}),this.legalEntityModel.docs=[{index:Object(Zt.a)()}])}onCancel(){this.searchModel.eik=null,this.searchModel.leName=null,this.searchModel.uin=null,this.searchModel.uinType=null,this.searchFormDisabled=!1,this.showForm=!1}loadTypes(){this.crudService.loadByParam(De.a,De.a.publicUrlDomain,"IND_OR_ENT").subscribe(e=>{this.types=e})}resultMsg(){this.searchResultText=this.searchResult?"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u0441 \u043f\u043e\u0441\u043e\u0447\u0435\u043d\u0438\u0442\u0435 \u0444\u0438\u043b\u0442\u0440\u0438 \u0437\u0430 \u0442\u044a\u0440\u0441\u0435\u043d\u0435 \u0432\u0435\u0447\u0435 \u0435 \u043d\u0430\u043b\u0438\u0447\u043d\u0430 \u0432 \u041d\u0418\u0421\u041e.\n      \u041d\u043e\u0432\u043e \u0437\u0430\u044f\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f, \u0437\u0430 \u0441\u044a\u0449\u043e\u0442\u043e \u0437\u0430\u0434\u044a\u043b\u0436\u0435\u043d\u043e \u043b\u0438\u0446\u0435, \u043d\u0435 \u0441\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0432\u0430.":'\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u0441 \u043f\u043e\u0441\u043e\u0447\u0435\u043d\u0438\u0442\u0435 \u0444\u0438\u043b\u0442\u0440\u0438 \u0437\u0430 \u0442\u044a\u0440\u0441\u0435\u043d\u0435 \u043d\u0435 \u0435 \u043d\u0430\u043b\u0438\u0447\u043d\u0430 \u0432 \u041d\u0418\u0421\u041e.\n      \u0417\u0430 \u0434\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0430\u0442\u0435 \u0437\u0430\u0434\u044a\u043b\u0436\u0435\u043d\u043e \u043b\u0438\u0446\u0435, \u0438\u0437\u0431\u0435\u0440\u0435\u0442\u0435 \u0431\u0443\u0442\u043e\u043d "\u041f\u043e\u0434\u0430\u0439 \u0437\u0430\u044f\u0432\u043b\u0435\u043d\u0438\u0435".'}}return e.\u0275fac=function(t){return new(t||e)(n.Mb(Yt.a),n.Mb(f.a))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-debtors"]],decls:16,vars:11,consts:[[1,"container-fluid","p-3"],[1,"text-center","mb-4"],["id","accordion",3,"destroyOnHide","activeIds"],["acc","ngbAccordion"],["id","search"],["ngbPanelHeader",""],["id","body","ngbPanelContent",""],[3,"model","cancel",4,"ngIf"],[1,"d-flex","align-items-center","justify-content-between"],[1,"m-0"],["ngbPanelToggle","",1,"btn","btn-sm","btn-outline-secondary","rounded-circle"],[1,"fas","fa-chevron-right",3,"hidden"],[1,"fas","fa-chevron-down",3,"hidden"],["novalidate","",1,"was-validated"],["searchForm","ngForm"],[1,"mb-3"],[3,"disabled"],[1,"row",2,"min-height","7.8rem"],[1,"col-lg-4"],[3,"source","ngModel","formItemDef","name","labelFieldName","valueFieldName","ngModelChange","valueEmitter"],["class","col-lg-4",4,"ngIf"],[1,"d-flex","justify-content-between"],[4,"ngIf"],["type","button","container","body",1,"btn","btn-outline-secondary",3,"disabled","click"],[3,"ngModel","formItemDef","name","isSearchable","searchDisabled","ngModelChange","searchEmitter"],[3,"ngModel","formItemDef","name","isSearchable","searchDisabled","showValidationCheck","ngModelChange","searchEmitter"],[3,"model","cancel"]],template:function(e,t){1&e&&(n.Sb(0,"div",0),n.Sb(1,"div",1),n.Sb(2,"div"),n.Sb(3,"h4"),n.Gc(4),n.hc(5,"translate"),n.Rb(),n.Sb(6,"h6"),n.Gc(7),n.hc(8,"translate"),n.Rb(),n.Rb(),n.Rb(),n.Sb(9,"ngb-accordion",2,3),n.Sb(11,"ngb-panel",4),n.Ec(12,Qt,8,5,"ng-template",5),n.Ec(13,is,20,23,"ng-template",6),n.Rb(),n.Rb(),n.Ec(14,as,1,1,"app-individual-form",7),n.Ec(15,rs,1,1,"app-legal-entity-form",7),n.Rb()),2&e&&(n.zb(4),n.Hc(n.ic(5,6,"applications.mro.application")),n.zb(3),n.Ic(" ",n.ic(8,8,"applications.debtors.subtitle")," "),n.zb(2),n.mc("destroyOnHide",!1)("activeIds",n.pc(10,ns)),n.zb(5),n.mc("ngIf","I"===t.searchModel.selectedType&&t.showForm),n.zb(1),n.mc("ngIf","E"===t.searchModel.selectedType&&t.showForm))},directives:[c.a,c.I,c.K,c.J,i.u,c.M,he.D,he.p,he.q,Le.a,he.o,he.r,xe.a,je.a,Q.a,ee.a],pipes:[l.d],styles:["[_nghost-%COMP%]     #accordion>div>div.card-header, [_nghost-%COMP%]     #accordion>div>div>div.card-body{padding:.5rem}"]}),e})()}],canActivate:[R.b],data:{permissions:{only:[p.a.IF_LOGGED],redirectTo:"/base/unauthorized"}}},{path:"teamdata",component:$t,children:[{path:x.a.ORGANIZATION_PROFILE,component:ie,canActivate:[R.b],data:{permissions:{only:["TEAMDATA_9_1.RW","TEAMDATA_9_1.R"],redirectTo:"/base/unauthorized"}}},{path:x.a.INVITATION,component:Ie,canActivate:[R.b],data:{permissions:{only:["TEAMDATA_9_2.RW","TEAMDATA_9_2.R"],redirectTo:"/base/unauthorized"}}},{path:x.a.USER_ORG_ACCESS_MANAGEMENT,component:gt,canActivate:[R.b],data:{permissions:{only:["TEAMDATA_9_3.RW","TEAMDATA_9_3.R"],redirectTo:"/base/unauthorized"}}},{path:x.a.USER_STAGES,component:At,canActivate:[R.b],data:{permissions:{only:["TEAMDATA_9_4.RW","TEAMDATA_9_4.R"],redirectTo:"/base/unauthorized"}}}],canActivate:[R.b],data:{permissions:{only:["TEAMDATA_9.RW","TEAMDATA_9.R"],redirectTo:"/base/unauthorized"}}},{path:"activate-profile/:token",component:Bt},{path:"reset-password/:token",component:Ht},{path:"**",redirectTo:"login",pathMatch:"full"}]},{path:"**",redirectTo:""}];let cs=(()=>{class e{}return e.\u0275mod=n.Kb({type:e}),e.\u0275inj=n.Jb({factory:function(t){return new(t||e)},imports:[[a.g.forChild(os)],a.g]}),e})();var ds=s("PCNd");let ls=(()=>{class e{}return e.\u0275mod=n.Kb({type:e}),e.\u0275inj=n.Jb({factory:function(t){return new(t||e)},imports:[[i.c,cs,ds.a]]}),e})()},bYRt:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var i=s("mrSG"),a=s("hnrn");let r=(()=>{class e{constructor(e){Object.assign(this,e||{})}get id(){return this.pId}set id(e){this.pId=e}get usrId(){return this.pUsrId}set usrId(e){this.pUsrId=e}get ornId(){return this.pOrnId}set ornId(e){this.pOrnId=e}get roleId(){return this.pRoleId}set roleId(e){this.pRoleId=e}get email(){return this.pEmail}set email(e){this.pEmail=e}get dateCreated(){return this.pDateCreated}set dateCreated(e){this.pDateCreated=e}get dateExpired(){return this.pDateExpired}set dateExpired(e){this.pDateExpired=e}get isSigned(){return this.pIsSigned}set isSigned(e){this.pIsSigned=e}get stdId(){return this.pStdId}set stdId(e){this.pStdId=e}get notes(){return this.pNotes}set notes(e){this.pNotes=e}get userCreated(){return this.pUserCreated}set userCreated(e){this.pUserCreated=e}get status(){return this.pStatus}set status(e){this.pStatus=e}}return e.url="TrnUserOrganization",Object(i.b)([Object(a.b)({alias:"id"})],e.prototype,"pId",void 0),Object(i.b)([Object(a.b)({alias:"usrId"})],e.prototype,"pUsrId",void 0),Object(i.b)([Object(a.b)({alias:"ornId"})],e.prototype,"pOrnId",void 0),Object(i.b)([Object(a.b)({alias:"roleId"})],e.prototype,"pRoleId",void 0),Object(i.b)([Object(a.b)({alias:"email"})],e.prototype,"pEmail",void 0),Object(i.b)([Object(a.b)({alias:"dateCreated"})],e.prototype,"pDateCreated",void 0),Object(i.b)([Object(a.b)({alias:"dateExpired"})],e.prototype,"pDateExpired",void 0),Object(i.b)([Object(a.b)({alias:"isSigned"})],e.prototype,"pIsSigned",void 0),Object(i.b)([Object(a.b)({alias:"stdId"})],e.prototype,"pStdId",void 0),Object(i.b)([Object(a.b)({alias:"notes"})],e.prototype,"pNotes",void 0),Object(i.b)([Object(a.b)({alias:"userCreated"})],e.prototype,"pUserCreated",void 0),Object(i.b)([Object(a.b)({alias:"status"})],e.prototype,"pStatus",void 0),e})()},u7yH:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var i=s("F7pt"),a=s("fXoL");let r=(()=>{class e{constructor(){}getSearchDefs(){const e=[],t=i.a.createDefaultRadioGroupDef();t.domId="individual_radio",t.labelText="",t.helpText="",t.isRequired=!1,e.push(t);const s=i.a.createDefaultRadioGroupDef();s.domId="legal_entity_radio",s.labelText="",s.helpText="",s.isRequired=!1,e.push(s);const a=i.a.createDefaultTextFormItemDef();a.domId="uin",a.labelText="fi.uin.label",a.helpText="\u0412\u044a\u0432\u0435\u0434\u0435\u0442\u0435 \u0436\u0435\u043b\u0430\u043d\u043e\u0442\u043e \u043e\u0442 \u0412\u0430\u0441 \u043b\u0438\u0446\u0435 \u0438 \u043d\u0430\u0442\u0438\u0441\u043d\u0435\u0442\u0435 \u0431\u0443\u0442\u043e\u043d\u0430 \u0437\u0430 \u0442\u044a\u0440\u0441\u0435\u043d\u0435, \u0437\u0430 \u0434\u0430 \u043f\u0440\u043e\u0434\u044a\u043b\u0436\u0438\u0442\u0435",a.isRequired=!0,e.push(a);const r=i.a.createDefaultTextFormItemDef();r.domId="eik",r.labelText="applications.debtors.legalEntity.eik",r.helpText="\u0412\u044a\u0432\u0435\u0434\u0435\u0442\u0435 \u0436\u0435\u043b\u0430\u043d\u0430\u0442\u0430 \u043e\u0442 \u0412\u0430\u0441 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u0438 \u043d\u0430\u0442\u0438\u0441\u043d\u0435\u0442\u0435 \u0431\u0443\u0442\u043e\u043d\u0430 \u0437\u0430 \u0442\u044a\u0440\u0441\u0435\u043d\u0435, \u0437\u0430 \u0434\u0430 \u043f\u0440\u043e\u0434\u044a\u043b\u0436\u0438\u0442\u0435",r.isRequired=!0,e.push(r);const n=i.a.createDefaultTextFormItemDef();return n.domId="legal_entity_name",n.labelText="applications.debtors.legalEntity.name",n.helpText="",n.isRequired=!1,n.isDisabled=!0,e.push(n),e}getIndividualDefs(){return[]}getLegalEntityDefs(){return[]}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=a.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},wt70:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var i=s("mrSG"),a=s("hnrn");let r=(()=>{class e{constructor(e){Object.assign(this,e||{}),this.hour=0,this.minute=0,this.second=0}get year(){return this.pYear}set year(e){this.pYear=e}get month(){return this.pMonth}set month(e){this.pMonth=e}get day(){return this.pDay}set day(e){this.pDay=e}get hour(){return this.pHour}set hour(e){this.pHour=e}get minute(){return this.pMinute}set minute(e){this.pMinute=e}get second(){return this.pSecond}set second(e){this.pSecond=e}}return Object(i.b)([Object(a.b)({alias:"year"})],e.prototype,"pYear",void 0),Object(i.b)([Object(a.b)({alias:"month"})],e.prototype,"pMonth",void 0),Object(i.b)([Object(a.b)({alias:"day"})],e.prototype,"pDay",void 0),Object(i.b)([Object(a.b)({alias:"hour"})],e.prototype,"pHour",void 0),Object(i.b)([Object(a.b)({alias:"minute"})],e.prototype,"pMinute",void 0),Object(i.b)([Object(a.b)({alias:"second"})],e.prototype,"pSecond",void 0),e})()}}]);